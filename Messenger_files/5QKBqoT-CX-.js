if (self.CavalryLogger) { CavalryLogger.start_js(["QMytV"]); }

__d("MessagesViewerSetID",[],(function a(b,c,d,e,f,g){f.exports={MESSAGES:"messages",MESSAGES_VIEW_ALL_IN_THREAD:"messages:view_all_in_thread"};}),null);
__d("MessengerWebDriverTestIDs",[],(function a(b,c,d,e,f,g){f.exports={ANIMATED_IMAGE:"animated_image",ATTACHMENT_ROOT:"attachment_root",CHAT_SIDEBAR:"chat_sidebar",INFO_PANEL:"info_panel",INFO_PANEL_BUTTON:"info_panel_button",INFO_PANEL_TOGGLER_OPTION:"info_panel_toggler_option",STICKER:"sticker"};}),null);
__d('ChatSpeakingSticker.react',['React','ReactDOM'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').PureComponent);i=h&&h.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.$ChatSpeakingSticker1=function(){var q=c('ReactDOM').findDOMNode(this.refs.stickerVideo);q.play();}.bind(this),m;}k.prototype.render=function(){return (c('React').createElement('div',{onClick:this.$ChatSpeakingSticker1},c('React').createElement('video',{height:this.props.videoSize.height,ref:"stickerVideo",width:this.props.videoSize.width},c('React').createElement('source',{src:this.props.videoURI}))));};k.propTypes={videoURI:j.string.isRequired,videoSize:j.shape({height:j.number,width:j.number}).isRequired};f.exports=k;}),null);
__d('MessagesViewer',['AsyncRequest','DOM','MessagesViewerSetID','PhotoStore','React','ReactDOM','emptyFunction','ge'],(function a(b,c,d,e,f,g){var h={renderSpotlight:function j(k,l,m,n){var o=k.setID;if(!o)o=c('MessagesViewerSetID').MESSAGES;i(c('React').createElement(m,{actorid:k.actorid,dimensions:[k.dimensions],disablepaging:k.disablePaging,disableForward:k.disableForward,forwardDialogComponent:n,open:true,photoid:k.fbid,reverse:false,rootClassName:k.rootClassName,setid:o,snapToPhoto:k.snapToPhoto,thumbsrc:k.src}));if(!c('PhotoStore').hasBeenCreated(o)&&k.endpoint){var p=new (c('AsyncRequest'))(k.endpoint);if(l)p.setRelativeTo(l);p.send();}},renderVideo:function j(k){i(k);}};function i(j){var k=c('ge')('messages_viewer');if(!k){k=c('DOM').create('div',{id:'messages_viewer'});document.body.appendChild(k);}c('ReactDOM').render(j,k,function(){this.subscribeOnce('close',function(){c('ReactDOM').unmountComponentAtNode(k);});});}f.exports=h;}),null);
__d('MessengerAttachmentViewer',['Bootloader','MessagesViewer','React','Run','emptyFunction'],(function a(b,c,d,e,f,g){'use strict';var h={renderVideo:function i(j){c('Bootloader').loadModules(["MessagingVideoViewer.react","MessengerForwardAttachmentDialog.react"],function(k,l){c('MessagesViewer').renderVideo(c('React').createElement(k,babelHelpers['extends']({},j,{forwardDialogComponent:l})));},'MessengerAttachmentViewer');},bootstrapWithConfig:function i(j,k){c('Bootloader').loadModules(["SpotlightMessagesViewer","MessengerForwardAttachmentDialog.react"],function(l,m){c('MessagesViewer').renderSpotlight(j,k,l,m);},'MessengerAttachmentViewer');},preload:function i(){c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["MessagingVideoViewer.react","SpotlightMessagesViewer","MessengerForwardAttachmentDialog.react"],c('emptyFunction'),'MessengerAttachmentViewer');});}};f.exports=h;}),null);
__d('MessengerFromViewerUtils',['CurrentUser','MercuryIDs'],(function a(b,c,d,e,f,g){'use strict';function h(i){return i.author===c('MercuryIDs').getParticipantIDFromUserID(c('CurrentUser').getID());}f.exports={isFromViewer:h};}),null);
__d('MessengerPhoto.react',['cx','Image.react','MercuryAttachmentType','MercuryConfig','MessengerSpinner.react','MessengerWebDriverTestIDs','React','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes,l=206,m=280,n=480,o=1800,p=450;function q(u,v){if(u.metadata){if(u.attach_type===c('MercuryAttachmentType').VIDEO)return v&&u.metadata.large_preview?u.metadata.large_preview:u.metadata.inbox_preview;return v?u.large_preview_url:u.preview_url;}return null;}function r(u){var v=c('MercuryConfig').MessengerLargePreviewImageGK?n:l,w=c('MercuryConfig').MessengerLargePreviewImageGK?m:l,x=c('MercuryConfig').MessengerLargePreviewImageGK&&window.screen.width>o;if(u.preview_uploading)return x&&u.large_preview_url?{height:u.large_preview_height||v,src:u.large_preview_url,width:u.large_preview_width||v,renderLargePreview:true}:{height:u.preview_height||w,src:u.preview_url,width:u.preview_width||w};var y=q(u,x);if(y){var z=x&&u.metadata.large_size?u.metadata.large_size:u.metadata.inbox_size;return babelHelpers['extends']({src:y,renderLargePreview:x},z);}if(u.preview_url)return x&&u.large_preview_url?{height:u.large_preview_height,src:u.large_preview_url,width:u.large_preview_width,renderLargePreview:true}:{height:u.preview_height,src:u.preview_url,width:u.preview_width};if(u.media)return u.media.playable&&u.media.animated_image?babelHelpers['extends']({},u.media.animated_image_size,{src:u.media.animated_image}):babelHelpers['extends']({},u.media.image_size,{src:u.media.image});return null;}function s(u,v){if(u.preview_uploading){var w=c('MercuryConfig').MessengerLargePreviewImageGK?m:l;return u.preview_url?0:w;}var x=u.media?r(u):{height:u.preview_height,width:u.preview_width};return Math.min(x.height*Math.min(1,p/x.width),p);}i=babelHelpers.inherits(t,c('React').Component);j=i&&i.prototype;function t(){var u,v;for(var w=arguments.length,x=Array(w),y=0;y<w;y++)x[y]=arguments[y];return v=(u=j.constructor).call.apply(u,[this].concat(x)),this.$MessengerPhoto2=function(z){z.preventDefault();var aa=this.props.attachment;if(this.props.onClick)this.props.onClick(aa);}.bind(this),v;}t.prototype.componentDidMount=function(){var u=this.props.onAttachmentLoad;u&&u();};t.prototype.render=function(){var u=this.props,v=u.attachment,w=u.isSingle,x=r(v);if(!x)return null;var y=v.attach_type===c('MercuryAttachmentType').ANIMATED_IMAGE,z=!!this.props.attachment.app_attribution,aa=this.$MessengerPhoto1(x,w&&y,(z?"_mxz":'')+(w&&!z?' '+"_52mr":'')),ba={};if(!y||!w){if(x.src)ba.backgroundImage='url('+x.src+')';if(w){var ca=s(v,this.context);if(ca)ba.minHeight=ca;}}var da=void 0;if(v.preview_uploading)da=c('React').createElement(c('MessengerSpinner.react'),null);var ea=y?c('MessengerWebDriverTestIDs').ANIMATED_IMAGE:null;return c('React').createElement('div',{className:c('joinClasses')(this.props.className,"_4tsk"+(z?' '+"_mxz":'')+(w&&!z?' '+"_52mr":'')+(v.preview_uploading&&!x.src?' '+"_3etv":'')),'data-testid':ea,style:ba,onClick:this.$MessengerPhoto2},aa,da,c('React').createElement('a',{className:"_4tsl",href:x.src},this.props.children));};t.prototype.$MessengerPhoto1=function(u,v,w){if(this.props.attachment.preview_uploading&&!u.src)return null;if(this.props.isSingle){var x={width:'100%',maxWidth:'100%'};x.maxHeight=u.renderLargePreview?window.screen.height*.7:window.screen.height*.65;return (c('React').createElement(c('Image.react'),{alt:'',className:c('joinClasses')(w,!v?"_5pf5":''),style:x,src:u.src}));}return null;};t.contextTypes={width:k.number};t.propTypes={attachment:k.object.isRequired,isSingle:k.bool.isRequired,onAttachmentLoad:k.func,onClick:k.func};f.exports=t;}),null);
__d('randomShuffle',['randomInt'],(function a(b,c,d,e,f,g){function h(i){for(var j=i.length-1;j>0;j--){var k=c('randomInt').call(this,j+1);if(k!=j){var l=i[k];i[k]=i[j];i[j]=l;}}return i;}f.exports=h;}),null);
__d('MessagingFlowerCornerArrangements',['invariant','ix','Random','randomShuffle'],(function a(b,c,d,e,f,g,h,i){'use strict';var j={TOP_LEFT:'topLeft',BOTTOM_RIGHT:'bottomRight'},k={PINK:'pink',PURPLE:'purple',YELLOW:'yellow'},l={ROUND:'round',POINTY:'pointy'},m=-10;function n(r,s){this.$ElementProducer1=r;this.$ElementProducer4=s;this.$ElementProducer2=c('Random').random()<.5;this.$ElementProducer3=[];var t=[k.PINK,k.PURPLE,k.YELLOW],u=[l.ROUND,l.POINTY,c('Random').random()>=.5?l.ROUND:l.POINTY];c('randomShuffle')(t);c('randomShuffle')(u);for(var v=0;v<3;v++)this.$ElementProducer3.push(this.$ElementProducer5(t[v],u[v]));}n.prototype.$ElementProducer6=function(r){switch(r){case k.PINK:return i('/images/messaging/flowerborder/pinkPointyFlower.png');case k.PURPLE:return i('/images/messaging/flowerborder/purplePointyFlower.png');case k.YELLOW:default:return i('/images/messaging/flowerborder/yellowPointyFlower.png');}};n.prototype.$ElementProducer7=function(r){switch(r){case k.PINK:return i('/images/messaging/flowerborder/pinkRoundFlower.png');case k.PURPLE:return i('/images/messaging/flowerborder/purpleRoundFlower.png');case k.YELLOW:default:return i('/images/messaging/flowerborder/yellowRoundFlower.png');}};n.prototype.$ElementProducer5=function(r,s){return s===l.POINTY?this.$ElementProducer6(r):this.$ElementProducer7(r);};n.prototype.$ElementProducer8=function(){return this.$ElementProducer3.pop();};n.prototype.flower=function(r){var s=c('Random').random()*360;return this.$ElementProducer9(this.$ElementProducer8(),{pivot:.5,rotationStart:s+r.rotationStartOffset,rotationEnd:s,scale:r.scale,x:r.x,y:r.y});};n.prototype.leaf=function(r){return this.$ElementProducer9(i('images/messaging/flowerborder/leaf.png'),{pivot:1,rotationStart:0,rotationEnd:r.rotationEnd,scale:r.scale,x:r.x,y:r.y});};n.prototype.$ElementProducer9=function(r,s){var t=s.pivot*100+'%',u=s.x+m,v=s.y+m,w=-s.pivot*100,x=s.scale,y=s.rotationEnd,z=void 0,aa=void 0,ba=void 0,ca=void 0;if(this.$ElementProducer2){var da=u;u=v;v=da;y=-y;}if(this.$ElementProducer1===j.BOTTOM_RIGHT){ca=this.$ElementProducer4+u+'px';aa=this.$ElementProducer4+v+'px';w=100+w;y+=180;}else if(this.$ElementProducer1===j.TOP_LEFT){ba=this.$ElementProducer4+u+'px';z=this.$ElementProducer4+v+'px';}else h(0);var ea=[];if(w!==0)ea.push('translate('+w+'%, '+w+'%)');ea.push('scale('+x+')');if(y!==0)ea.push('rotate('+y+'deg)');return {style:{bottom:aa,left:ba,position:'absolute',right:ca,top:z,transform:ea.join(' '),transformOrigin:t+' '+t},image:r};};function o(r){return [r.leaf({x:20.5,y:38,scale:.225,rotationEnd:-80}),r.leaf({x:29,y:22.5,scale:.35,rotationEnd:35}),r.flower({x:31.5,y:22,scale:.6,rotationStartOffset:-70}),r.flower({x:21,y:35,scale:.65,rotationStartOffset:-70}),r.flower({x:21.75,y:24.75,scale:1,rotationStartOffset:50})];}function p(r){return [r.leaf({x:22.25,y:35.25,scale:.225,rotationEnd:-115}),r.leaf({x:35,y:24,scale:.35,rotationEnd:110}),r.flower({x:21.5,y:32.5,scale:.68,rotationStartOffset:-60}),r.flower({x:21.5,y:23.5,scale:.67,rotationStartOffset:-70}),r.flower({x:31,y:21,scale:.95,rotationStartOffset:50})];}function q(r,s){var t=new n(r,s);return c('Random').random()<.5?o(t):p(t);}f.exports={createFlowers:q,corners:j};}),null);
__d('MessagingFlowerBorder.react',['Image.react','MessagingFlowerCornerArrangements','React'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').PureComponent);i=h&&h.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.$MessagingFlowerBorder1=function(){return c('MessagingFlowerCornerArrangements').createFlowers(c('MessagingFlowerCornerArrangements').corners.TOP_LEFT,this.props.offset).concat(c('MessagingFlowerCornerArrangements').createFlowers(c('MessagingFlowerCornerArrangements').corners.BOTTOM_RIGHT,this.props.offset));}.bind(this),this.state={elements:this.$MessagingFlowerBorder1()},m;}k.prototype.render=function(){return (c('React').createElement('div',null,this.state.elements.map(function(l,m){return c('React').createElement(c('Image.react'),{key:m,style:l.style,src:l.image});})));};k.propTypes={ChildClass:j.number};k.defaultProps={offset:0};f.exports=k;}),null);
__d('MessagingGiftWrap.react',['cx','MessengerEnvironment','React','emptyFunction'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').PureComponent);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={unwrapped:false},this.$MessagingGiftWrap1=function(r){r.stopPropagation();this.setState({unwrapped:true});this.props.onUnwrap&&this.props.onUnwrap();}.bind(this),n;}l.prototype.render=function(){var m=c('MessengerEnvironment').messengerui;return c('React').createElement('div',{className:"_4p0m"+(this.state.unwrapped?' '+"_4p0o":'')+(m?' '+"_mxz":'')+(m?' '+"_4br2":'')+(!m?' '+"_3_om":'')+(this.props.isSticker?' '+"_52vq":''),onClick:this.$MessagingGiftWrap1},c('React').createElement('div',{className:"_4p0r"}),c('React').createElement('div',{className:"_4p0s _4p0t"}),c('React').createElement('div',{className:"_4p0s _4p0u"}));};l.propTypes={isSticker:k.bool,onUnwrap:k.func};l.defaultProps={onUnwrap:c('emptyFunction')};f.exports=l;}),null);
__d('MessengerPhotoForwardButton.react',['cx','fbt','Link.react','MessengerActions','MessengerForwardAttachmentDialog.react','React','TooltipData'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').PureComponent);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$MessengerPhotoForwardButton1=function(){var s=i._("Transf\u00e9rer dans des messages s\u00e9par\u00e9s");c('MessengerActions').showDialog(c('MessengerForwardAttachmentDialog.react'),{attachmentID:this.props.photoIDs[0],onClose:this.$MessengerPhotoForwardButton2,shown:true,title:s});}.bind(this),o;}m.prototype.render=function(){var n=i._("Transf\u00e9rer"),o=this.props.isFromViewer?'left':'right',p=Object.assign({'data-tooltip-alignh':o},c('TooltipData').propsFor(n,o));return c('React').createElement(c('Link.react'),babelHelpers['extends']({},this.props,p,{'aria-label':n,onClick:this.$MessengerPhotoForwardButton1,ref:'forwardButton',role:'button',className:"_cks"+(' '+"_2t5q")+(!this.props.isFromViewer?' '+"_2t5r":'')+(this.props.isFromViewer?' '+"_2t5s":'')}),c('React').createElement('div',{className:"_2t5t"}));};m.prototype.$MessengerPhotoForwardButton2=function(){c('MessengerActions').hideDialog();};m.propTypes={photoIDs:l.arrayOf(l.string).isRequired,isFromViewer:l.bool.isRequired};f.exports=m;}),null);
__d('MessengerSharedMediaReducer',['MessengerSharedMediaActions','MessengerThreadSharedMediaHelper','Set'],(function a(b,c,d,e,f,g){'use strict';var h=c('MessengerSharedMediaActions').Types;function i(r,s){switch(s.type){case h.LOAD_CURRENT:var t=r.get('sharedMedia').get(s.threadFBID);if(t){var u=t.edges.find(function(x){return x.node.legacy_attachment_id===s.photoID;});if(u)return r;}var v=r.get('isLoading').get(s.threadFBID);if(!!v&&v.curr)return r;var w=q(r,s.threadFBID,'curr',true);c('MessengerThreadSharedMediaHelper').search(s.threadFBID,s.photoID,function(x){return c('MessengerSharedMediaActions').currentLoaded(x);});return w;}return r;}function j(r,s){switch(s.type){case h.LOAD_MORE_PREVIOUS:var t=r.get('isLoading').get(s.threadFBID);if(!!t&&t.prev)return r;var u=q(r,s.threadFBID,'prev',true);if(u===null)return r;c('MessengerThreadSharedMediaHelper').loadMorePrevious(s.threadFBID,s.afterCursor,s.first,function(v){return c('MessengerSharedMediaActions').previousLoaded(v);});return u;}return r;}function k(r,s){switch(s.type){case h.LOAD_MORE_LATEST:var t=r.get('isLoading').get(s.threadFBID);if(!!t&&t.latest)return r;var u=q(r,s.threadFBID,'latest',true);if(u===null)return r;c('MessengerThreadSharedMediaHelper').loadMoreLatest(s.threadFBID,s.beforeCursor,s.last,function(v){return c('MessengerSharedMediaActions').latestLoaded(v);});return u;}return r;}function l(r,s){switch(s.type){case h.CURRENT_LOADED:var t=s.data,u=Object.keys(t)[0],v=t[u].message_shared_media,w=v.edges.length,x=q(r,u,'curr',false);if(w!==0){var y=p(r.get('sharedMedia').get(u),v,0),z=r.get('sharedMedia').set(u,y);x=x.set('sharedMedia',z);var aa=v.edges[0];c('MessengerThreadSharedMediaHelper').loadMorePrevious(u,aa.cursor,10,function(ba){return c('MessengerSharedMediaActions').previousLoaded(ba);});c('MessengerThreadSharedMediaHelper').loadMoreLatest(u,aa.cursor,10,function(ba){return c('MessengerSharedMediaActions').latestLoaded(ba);});}return x;}return r;}function m(r,s){switch(s.type){case h.PREVIOUS_LOADED:var t=s.data,u=Object.keys(t)[0],v=t[u].message_shared_media,w=q(r,u,'prev',false),x=p(r.get('sharedMedia').get(u),v,1),y=r.get('sharedMedia').set(u,x);w=w.set('sharedMedia',y);return w;}return r;}function n(r,s){switch(s.type){case h.LATEST_LOADED:var t=s.data,u=Object.keys(t)[0],v=t[u].message_shared_media,w=q(r,u,'latest',false),x=p(r.get('sharedMedia').get(u),v,-1),y=r.get('sharedMedia').set(u,x);w=w.set('sharedMedia',y);return w;}return r;}function o(r,s){switch(s.type){case h.DELETE_PHOTOS:var t=s.threadFBID,u=s.photoFBIDs,v=r.get('sharedMedia').get(t),w=new (c('Set'))(u.map(function(z){return z.toString();}));v.edges=v.edges.filter(function(z){return (!w.has(z.node.legacy_attachment_id));});var x=r.get('sharedMedia').set(t,v),y=r.set('sharedMedia',x);return y;}return r;}function p(r,s,t){var u={};u.count=s.count;if(t===1&&r){var v=r.edges;u.has_previous_page=r.has_previous_page;u.has_next_page=s.page_info.has_next_page;if(s.edges.length>0){u.edges=v.concat(s.edges);}else u.edges=v;}else if(t===-1&&r){var w=r.edges;u.has_previous_page=s.page_info.has_previous_page;u.has_next_page=r.has_next_page;if(s.edges.length>0){u.edges=s.edges.concat(w);}else u.edges=w;}else{u.has_previous_page=s.page_info.has_previous_page;u.has_next_page=s.page_info.has_next_page;if(s.edges.length>0)u.edges=s.edges;}return u;}function q(r,s,t,u){var v=r.get('isLoading').get(s);if(v===undefined){v={};v[t]=u;}else v[t]=u;var w=r.set('isLoading',r.get('isLoading').set(s,v));return w;}f.exports={currentLoaded:l,deletePhotos:o,latestLoaded:n,loadCurrent:i,loadMoreLatest:k,loadMorePrevious:j,previousLoaded:m};}),null);
__d('MessengerSharedMediaState',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={sharedMedia:c('immutable').Map({}),isLoading:c('immutable').Map({})};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d('MessengerSharedMediaStore',['MessengerFluxReduceDispatcher','MessengerSharedMediaActions','MessengerSharedMediaReducer','MessengerSharedMediaState','FluxReduceStore'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=[].concat(Object.values(c('MessengerSharedMediaReducer')));h=babelHelpers.inherits(k,c('FluxReduceStore'));i=h&&h.prototype;k.prototype.getInitialState=function(){return new (c('MessengerSharedMediaState'))();};k.prototype.reduce=function(l,m){if(m.namespace!==c('MessengerSharedMediaActions').Namespace)return l;return j.reduce(function(n,o){return o(n,m);},l);};function k(){h.apply(this,arguments);}f.exports=new k(c('MessengerFluxReduceDispatcher'));}),null);
__d('messengerSharedPhotosAlbumViewPhotoReact',['bs_curry','React','reactRe'],(function a(b,c,d,e,f,g){'use strict';var h=c('reactRe').StatelessComponent[0],i=c('reactRe').StatelessComponent[1],j=c('reactRe').StatelessComponent[2],k=c('reactRe').StatelessComponent[3],l=c('reactRe').StatelessComponent[4],m=c('reactRe').StatelessComponent[5];function n(t,u){var v=u[0];return c('bs_curry')._1(v[2],v[1]);}function o(t){var u=t[0];return c('React').createElement("a",{className:u[0],href:"#",onClick:c('bs_curry')._1(t[1],n),style:{backgroundImage:"url("+(u[3]+")")}});}var p=c('bs_curry')._8(m,"MessengerSharedPhotosAlbumViewPhotoReact",h,i,k,j,l,0,o),q=p[1];function r(t,u,v,w){return c('bs_curry')._1(q,[t,u,v,w]);}var s=p[0];g.getInstanceVariables=h;g.componentDidMount=i;g.componentDidUpdate=j;g.componentWillReceiveProps=k;g.componentWillUnmount=l;g.createClass=m;g.handleClick=n;g.render=o;g.comp=s;g.wrapProps=q;g.createElement=r;}),null);
__d('messengerSharedPhotosAlbumViewVScrollReact',['cx','Animation','bs_array','bs_caml_builtin_exceptions','bs_curry','MessengerSharedMediaActions','messengerSharedPhotosAlbumViewPhotoReact','React','ReactDOM','reactRe'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('reactRe').StatelessComponent[2],j=c('reactRe').StatelessComponent[3],k=c('reactRe').StatelessComponent[5];function l(){return [0,0,0,0];}function m(la){var ma=la[2].length;if(ma<48){return c('MessengerSharedMediaActions').loadMorePrevious(la[3],la[2][la[2].length-1|0].cursor,48);}else return 0;}function n(la){var ma=la[1];if(ma){var na=ma[0];return +((na.scrollTop+na.clientHeight|0)>=(na.scrollHeight-20|0));}else throw c('bs_caml_builtin_exceptions').not_found;}function o(la){var ma=la[1];if(ma){return +(ma[0].scrollTop<=20);}else throw c('bs_caml_builtin_exceptions').not_found;}function p(la,ma){var na=ma[3],oa=ma[0],pa=oa[2].length,qa=oa[4];if(n(na)){if(pa<qa&&!oa[0].prev){return c('MessengerSharedMediaActions').loadMorePrevious(oa[3],oa[2][oa[2].length-1|0].cursor,48);}else return 0;}else if(o(na)&&!oa[0].latest){return c('MessengerSharedMediaActions').loadMoreLatest(oa[3],oa[2][0].cursor,48);}else return 0;}function q(la){var ma=la[3];if(ma){return ma[0].clientHeight;}else throw c('bs_caml_builtin_exceptions').not_found;}function r(la,ma){var na=la[1];if(na){return new (c('Animation'))(na[0]).to("scrollTop",ma).duration(200).go();}else return 0;}function s(la){var ma=la[2];if(ma){return r(la,c('ReactDOM').findDOMNode(ma[0]).offsetTop-70|0);}else return 0;}function t(la){var ma=la[3],na=la[1];m(la[0]);var oa=ma[1];if(oa)oa[0].addEventListener("scroll",c('bs_curry')._1(na,p));if(q(ma)){return 0;}else{var pa=function qa(ra,sa){var ta=sa[3];if(q(ta)>0){var ua=ta[0];if(ua)clearInterval(ua[0]);return s(ta);}else return 0;};ma[0]=[setInterval(c('bs_curry')._1(na,pa),200)];return 0;}}function u(la){var ma=la[3],na=ma[1];if(na)na[0].removeEventListener("scroll",c('bs_curry')._1(la[1],p));var oa=ma[0];if(oa){clearInterval(oa[0]);return 0;}else return 0;}function v(la,ma){ma[3][1]=[la];return 0;}function w(la,ma){ma[3][3]=[la];return 0;}function x(la,ma){ma[3][2]=[la];return 0;}function y(la,ma){ma[3][2]=0;return 0;}function z(la,ma){return c('bs_array').map(function(na){var oa=na.node,pa=+(oa.legacy_attachment_id===la[5]);return c('bs_curry')._4(c('messengerSharedPhotosAlbumViewPhotoReact').createElement("_3bly",oa.legacy_attachment_id,la[1],oa.image1.uri),0,[pa!==0?c('bs_curry')._1(ma,x):c('bs_curry')._1(ma,y)],[oa.legacy_attachment_id],0);},la[2]);}function aa(la){var ma=la[2];return c('React').createElement("div",{className:"_3xo8",ref:c('bs_curry')._1(ma,v),onscroll:c('bs_curry')._1(la[1],p)},c('React').createElement("div",{className:"_3xoa",ref:c('bs_curry')._1(ma,w)},z(la[0],ma)));}function ba(la){return [la.isLoading,la.onClick,la.sharedPhotos,la.threadID,la.totalCount,la.viewedPhoto];}var ca=c('bs_curry')._8(k,"MessengerSharedPhotosAlbumViewVScrollReact",l,t,j,i,u,[ba],aa),da=ca[1];function ea(la,ma,na,oa,pa,qa){return c('bs_curry')._1(da,[la,ma,na,oa,pa,qa]);}var fa=200,ga=48,ha=6,ia=20,ja=70,ka=ca[0];g.componentDidUpdate=i;g.componentWillReceiveProps=j;g.createClass=k;g.animationDuration=fa;g.imagesToLoad=ga;g.photosPerRow=ha;g.scrollToEdgeTolerance=ia;g.headerHeight=ja;g.getInstanceVariables=l;g.graduallyLoadPhotos=m;g.isScrolledToBottom=n;g.isScrolledToTop=o;g.handleScroll=p;g.getScrollHeight=q;g.scrollTo=r;g.autoScrollWhenLoaded=s;g.componentDidMount=t;g.componentWillUnmount=u;g.setRefChildContainer=v;g.setRefScrollable=w;g.setRefChild=x;g.setRefChildNot=y;g.renderChildren=z;g.render=aa;g.jsPropsToReasonProps=ba;g.comp=ka;g.wrapProps=da;g.createElement=ea;}),null);
__d('MessengerSharedPhotosAlbumView.react',['cx','fbt','messengerSharedPhotosAlbumViewVScrollReact','MessengerPhotoViewCloseLink.react','React'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('messengerSharedPhotosAlbumViewVScrollReact').comp,m=c('React').PropTypes;j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.$MessengerSharedPhotosAlbumView2=function(){this.props.onClick(this.props.viewedPhoto);}.bind(this),this.$MessengerSharedPhotosAlbumView1=function(){return (c('React').createElement('div',{className:"_3bm0 _5l-3",ref:'header'},c('React').createElement('div',{className:"_3bm2",onClick:this.$MessengerSharedPhotosAlbumView2},c('React').createElement('div',{className:"_3bm3"}),i._("Retour \u00e0 la photo")),c('React').createElement('div',{className:"_3bm4"},i._("Photos partag\u00e9es")),c('React').createElement(c('MessengerPhotoViewCloseLink.react'),{onClick:this.props.onCloseSharedPhotos})));}.bind(this),p;}n.prototype.render=function(){return c('React').createElement('div',{className:"_3bl- _5l-3",ref:'window'},this.$MessengerSharedPhotosAlbumView1(),c('React').createElement(l,{isLoading:this.props.isLoading,onClick:this.props.onClick,sharedPhotos:this.props.sharedPhotos,threadID:this.props.threadID,totalCount:this.props.totalCount,viewedPhoto:this.props.viewedPhoto}));};n.propTypes={onClick:m.func.isRequired,onCloseSharedPhotos:m.func.isRequired,sharedPhotos:m.arrayOf(m.object).isRequired,totalCount:m.number.isRequired,viewedPhoto:m.string.isRequired,threadID:m.string.isRequired,isLoading:m.object.isRequired};f.exports=n;}),null);
__d('MessengerSharedPhotosAlbumViewContainer.react',['FluxContainer','MessengerSharedMediaStore','React','MessengerSharedPhotosAlbumView.react'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').PureComponent);i=h&&h.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.state={edges:[],count:0,isLoading:{}},m;}k.getStores=function(){return [c('MessengerSharedMediaStore')];};k.calculateState=function(l,m){var n=c('MessengerSharedMediaStore').getState(),o=n.sharedMedia;return {edges:o.get(m.threadID).edges,count:o.get(m.threadID).count,isLoading:n.isLoading.get(m.threadID)};};k.prototype.render=function(){if(this.state.edges.length===0)return null;return (c('React').createElement(c('MessengerSharedPhotosAlbumView.react'),{onClick:this.props.onClick,onCloseSharedPhotos:this.props.onCloseSharedPhotos,sharedPhotos:this.state.edges,totalCount:this.state.count,viewedPhoto:this.props.viewedPhoto,threadID:this.props.threadID,isLoading:this.state.isLoading}));};k.propTypes={onClick:j.func.isRequired,onCloseSharedPhotos:j.func.isRequired,viewedPhoto:j.string.isRequired,threadID:j.string};f.exports=c('FluxContainer').create(k,{withProps:true});}),null);
__d('MessengerPhotoViewBottomBar.react',['cx','React'],(function a(b,c,d,e,f,g,h){'use strict';var i=function j(k){return (c('React').createElement('div',{className:"_51an _50-m _16zz"},k.children));};f.exports=i;}),null);
__d('MessengerPhotoViewHScroll.react',['cx','Animation','MessengerSharedPhoto.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes,l=200,m=80;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.$MessengerPhotoViewHScroll1=null,p;}n.prototype.componentDidMount=function(){this.$MessengerPhotoViewHScroll2();};n.prototype.componentDidUpdate=function(){this.$MessengerPhotoViewHScroll2();};n.prototype.componentWillUnmount=function(){this.$MessengerPhotoViewHScroll1&&this.$MessengerPhotoViewHScroll1.stop();this.$MessengerPhotoViewHScroll1=null;};n.prototype.render=function(){var o=this.props.sharedPhotos,p=o.map(function(r){return (c('React').createElement('div',{className:"_4dy9",key:r.node.legacy_attachment_id},c('React').createElement(c('MessengerSharedPhoto.react'),{className:"_42rl"+(this.props.photoID!==r.node.legacy_attachment_id?' '+"_q1a":''),fbid:r.node.legacy_attachment_id,onClick:this.props.onScroll,uri:r.node.image1.uri})));}.bind(this)),q=(this.props.width-m)/2;return (c('React').createElement('div',{className:"_463g"},c('React').createElement('div',{className:"_463h",ref:'childContainer'},c('React').createElement('div',{className:"_463j",style:{paddingLeft:q,paddingRight:q},ref:'scrollable'},p))));};n.prototype.$MessengerPhotoViewHScroll2=function(){var o=this.refs.childContainer?this.refs.childContainer.scrollLeft:0,p=this.props.sharedPhotos.findIndex(function(r){return r.node.legacy_attachment_id===this.props.photoID;}.bind(this)),q=p*m;if(!this.$MessengerPhotoViewHScroll1)this.$MessengerPhotoViewHScroll1=new (c('Animation'))(this.refs.childContainer);this.$MessengerPhotoViewHScroll1.from('scrollLeft',o).to('scrollLeft',q).duration(l).go();};f.exports=n;}),null);
__d('MessengerPhotoViewHeader.react',['cx','fbt','MessengerActions','MessengerPhotoInfoDialogContainer.react','React','SpotlightViewerBottomBarLink','MessengerPhotoViewCloseLink.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').PureComponent);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$MessengerPhotoViewHeader2=function(){return (c('React').createElement(c('MessengerPhotoViewCloseLink.react'),{onClick:this.props.onClose}));}.bind(this),o;}m.prototype.render=function(){return c('React').createElement('div',{className:"_51an _50-m _3c1i _5l-3",role:'banner'},this.$MessengerPhotoViewHeader1(),this.$MessengerPhotoViewHeader2());};m.prototype.$MessengerPhotoViewHeader1=function(){var n=void 0;if(!this.props.disableForward)n=c('React').createElement(c('SpotlightViewerBottomBarLink'),{className:"_3c1o",onClick:this.props.showForwardDialog,ref:'forwardButton'},c('React').createElement('div',{className:"_2msr _3oo2"}),i._("Transf\u00e9rer"));return (c('React').createElement('div',{key:'buttonsContainer',ref:'buttons'},c('React').createElement(c('SpotlightViewerBottomBarLink'),{ajaxify:this.props.url,className:"_3c1o",rel:'async'},c('React').createElement('div',{className:"_3ooo _2msr"}),i._("T\u00e9l\u00e9charger")),n,c('React').createElement(c('SpotlightViewerBottomBarLink'),{className:"_3c1o",href:'#',onClick:this.props.openInfo,ref:'moreInfo'},c('React').createElement('div',{className:"_3c1k _2msr"}),i._("Infos"))));};m.propTypes={disableForward:l.bool,onClose:l.func,openInfo:l.func,photoID:l.string,showForwardDialog:l.func,url:l.object};f.exports=m;}),null);
__d('SpotlightMessengerSharedMediaViewer.react',['csx','cx','fbt','invariant','ActorURI','MessengerPhotoViewHScroll.react','Event','KeyEventController','MessengerForwardAttachmentDialog.react','MessagingForwardingButtonNUX.react','MessengerPhotoInfoDialogContainer.react','MessengerPhotoViewHeader.react','MessengerSharedMediaActions','MessengerVideoPlayer.react','Parent','PhotoUtils','React','ReactFragment','SpotlightViewer','SpotlightViewerImage','SpotlightMessagesViewerPagers.react','SpotlightViewport','SubscriptionsHandler','Vector','XMessagingPhotoDownloadController','MessengerPhotoViewBottomBar.react'],(function a(b,c,d,e,f,g,h,i,j,k){'use strict';var l,m,n=c('React').PropTypes,o=88,p=80,q=30,r="_4-og";l=babelHelpers.inherits(s,c('React').Component);m=l&&l.prototype;function s(){var t,u;for(var v=arguments.length,w=Array(v),x=0;x<v;x++)w[x]=arguments[x];return u=(t=m.constructor).call.apply(t,[this].concat(w)),this.$SpotlightMessengerSharedMediaViewer1=undefined,this.$SpotlightMessengerSharedMediaViewer2=[],this.state={photoData:null,showForward:false,showInfo:false,stageDimensions:new (c('Vector'))()},this.$SpotlightMessengerSharedMediaViewer14=function(y){if(!this.props.sharedMedia)return;var z=this.props.sharedMedia.findIndex(function(ba){return ba.node.legacy_attachment_id===y;});if(z<0)return;var aa=this.props.sharedMedia[z];this.setState({photoData:aa});this.$SpotlightMessengerSharedMediaViewer17(z);}.bind(this),this.$SpotlightMessengerSharedMediaViewer4=function(y,event){if(this.state.photoData==null)return;var z=this.state.photoData;if(event&&!!c('Parent').bySelector(event.target,"._3tsq"))return;if(event&&event.target instanceof HTMLElement&&event.target.className===r)this.$SpotlightMessengerSharedMediaViewer7();var aa=this.props.sharedMedia.findIndex(function(ca){return ca.node.legacy_attachment_id===z.node.legacy_attachment_id;});if(aa<0||aa===this.props.sharedMedia.length-1&&!this.props.hasNextPage&&y)return;if(aa===0&&!y){c('MessengerSharedMediaActions').loadMoreLatest(this.props.threadID,this.props.sharedMedia[0].cursor,q);return;}var ba=y?this.props.sharedMedia[aa+1]:this.props.sharedMedia[aa-1];this.setState({photoData:ba});this.$SpotlightMessengerSharedMediaViewer17(aa);}.bind(this),this.$SpotlightMessengerSharedMediaViewer7=function(){if(this.props.photoID===null)return;this.setState({photoData:null});this.props.onClosePhotoView();}.bind(this),this.$SpotlightMessengerSharedMediaViewer12=function(){this.setState({showForward:true});this.refs.forwardNUX.close();}.bind(this),this.$SpotlightMessengerSharedMediaViewer15=function(){this.setState({showForward:false});}.bind(this),this.$SpotlightMessengerSharedMediaViewer11=function(){this.setState({showInfo:true});}.bind(this),this.$SpotlightMessengerSharedMediaViewer16=function(){this.setState({showInfo:false});}.bind(this),u;}s.prototype.componentDidMount=function(){var t=this.props.sharedMedia.find(function(u){return u.node.legacy_attachment_id===this.props.photoID;}.bind(this));this.setState({photoData:t,stageDimensions:this.$SpotlightMessengerSharedMediaViewer3()});this.$SpotlightMessengerSharedMediaViewer1=new (c('SubscriptionsHandler'))();this.$SpotlightMessengerSharedMediaViewer1.addSubscriptions(c('Event').listen(window,'resize',function(){this.setState({stageDimensions:this.$SpotlightMessengerSharedMediaViewer3()});}.bind(this)),c('KeyEventController').registerKey('LEFT',function(){this.$SpotlightMessengerSharedMediaViewer4(false);return false;}.bind(this)),c('KeyEventController').registerKey('RIGHT',function(){this.$SpotlightMessengerSharedMediaViewer4(true);return false;}.bind(this)));};s.prototype.componentWillUnmount=function(){this.$SpotlightMessengerSharedMediaViewer1&&this.$SpotlightMessengerSharedMediaViewer1.release();this.$SpotlightMessengerSharedMediaViewer1=null;this.$SpotlightMessengerSharedMediaViewer2.forEach(function(t){return t.abandon();});};s.prototype.render=function(){var t=this.$SpotlightMessengerSharedMediaViewer5(),u=this.state.stageDimensions,v=this.props.useloadingindicator&&!this.state.photoData;if(this.state.photoData==null)return null;var w=this.props.sharedMedia.findIndex(function(y){this.state.photoData!=null||k(0);return y.node.id===this.state.photoData.node.id;}.bind(this)),x=c('React').createElement('div',null,this.$SpotlightMessengerSharedMediaViewer6(),this.props.disablepaging?null:c('React').createElement(c('SpotlightMessagesViewerPagers.react'),{disablePrevArrow:w<=0&&!this.props.hasPrevPage,disableNextArrow:!this.props.hasNextPage&&w>=this.props.sharedMedia.length-1}));return c('React').createElement('span',null,c('React').createElement(c('SpotlightViewer'),{className:"_53vs",onHide:this.$SpotlightMessengerSharedMediaViewer7,open:this.props.photoID!==null,ref:'spotlightViewer',rootClassName:this.props.rootClassName},c('React').createElement(c('SpotlightViewport'),{active:false,fadeInNOut:true,media:t,onClick:this.$SpotlightMessengerSharedMediaViewer4,ref:'viewport',showLoadingIndicator:v,stageDimensions:u,useWidth:true},x),this.$SpotlightMessengerSharedMediaViewer8()),this.$SpotlightMessengerSharedMediaViewer9(),this.$SpotlightMessengerSharedMediaViewer10());};s.prototype.$SpotlightMessengerSharedMediaViewer6=function(){if(!this.state.photoData)return null;var t=this.state.photoData.node.legacy_attachment_id,u=c('XMessagingPhotoDownloadController').getURIBuilder().setString('photo_id',t).getURI();if(this.props.actorid)u=c('ActorURI').create(u,this.props.actorid);return c('React').createElement(c('MessengerPhotoViewHeader.react'),{disableForward:this.props.disableForward,onClose:this.$SpotlightMessengerSharedMediaViewer7,openInfo:this.$SpotlightMessengerSharedMediaViewer11,photoID:this.props.photoID,ref:'photoviewheader',showForwardDialog:this.$SpotlightMessengerSharedMediaViewer12,url:u});};s.prototype.$SpotlightMessengerSharedMediaViewer13=function(t){return t?Math.ceil(t/p):q;};s.prototype.$SpotlightMessengerSharedMediaViewer8=function(){if(!this.state.photoData)return null;var t=this.state.photoData,u=c('React').createElement('button',{className:"_2n5b",onClick:function(){return this.props.openAlbum(t.node.legacy_attachment_id);}.bind(this),type:'button'},c('React').createElement('div',{className:"_3por"}));return c('React').createElement(c('MessengerPhotoViewBottomBar.react'),null,c('React').createElement(c('MessengerPhotoViewHScroll.react'),{onScroll:this.$SpotlightMessengerSharedMediaViewer14,photoID:t.node.legacy_attachment_id,sharedPhotos:this.props.sharedMedia,width:this.state.stageDimensions.x}),u);};s.prototype.$SpotlightMessengerSharedMediaViewer9=function(){if(!this.state.photoData||this.props.disableForward)return null;var t=j._("Transf\u00e9rer dans des messages s\u00e9par\u00e9s");return c('ReactFragment').create({forwardDialog:c('React').createElement(c('MessengerForwardAttachmentDialog.react'),{attachmentID:this.state.photoData.node.legacy_attachment_id,onClose:this.$SpotlightMessengerSharedMediaViewer15,shown:this.state.showForward,title:t}),forwardButtonNUX:c('React').createElement(c('MessagingForwardingButtonNUX.react'),{contextRef:function(){return this.refs.forwardButton;}.bind(this),ref:'forwardNUX'},j._("Envoyer cette image \u00e0 d\u2019autres personnes dans des messages s\u00e9par\u00e9s."))});};s.prototype.$SpotlightMessengerSharedMediaViewer10=function(){return this.state.showInfo?c('React').createElement(c('MessengerPhotoInfoDialogContainer.react'),{closeInfo:this.$SpotlightMessengerSharedMediaViewer16,infoOpen:this.state.showInfo,photoID:this.state.photoData.node.id}):c('React').createElement('xhp',null);};s.prototype.$SpotlightMessengerSharedMediaViewer17=function(t){var u=this.$SpotlightMessengerSharedMediaViewer13(this.state.stageDimensions.x),v=this.props.sharedMedia;if(t<=u/2){c('MessengerSharedMediaActions').loadMoreLatest(this.props.threadID,v[0].cursor,u);if(v.length<u&&this.props.hasNextPage)c('MessengerSharedMediaActions').loadMorePrevious(this.props.threadID,v[v.length-1].cursor,u);}else if(t>=v.length-u/2&&this.props.hasNextPage)c('MessengerSharedMediaActions').loadMorePrevious(this.props.threadID,v[v.length-1].cursor,u);};s.prototype.$SpotlightMessengerSharedMediaViewer3=function(){var t=new (c('Vector'))(c('Vector').getViewportDimensions().x,c('Vector').getViewportDimensions().y-o);return t;};s.prototype.$SpotlightMessengerSharedMediaViewer5=function(){if(this.state.photoData&&this.state.photoData.node){var t=this.state.photoData.node;if(t.__typename&&t.__typename==='MessageVideo')return this.$SpotlightMessengerSharedMediaViewer18();var u=this.state.stageDimensions,v=this.$SpotlightMessengerSharedMediaViewer19(t,u);if(!v)return null;var w=s.getImageDimensionsForStage(new (c('Vector'))(v.width,v.height),u);return this.$SpotlightMessengerSharedMediaViewer20(v,w);}else return null;};s.prototype.$SpotlightMessengerSharedMediaViewer18=function(){if(this.state.photoData)return (c('React').createElement(c('MessengerVideoPlayer.react'),{isVisible:true,videoData:this.state.photoData.node,stageDimensions:this.state.stageDimensions}));return null;};s.prototype.$SpotlightMessengerSharedMediaViewer20=function(t,u){return (c('React').createElement(c('SpotlightViewerImage'),{dimensions:u,ref:'image',src:t.uri}));};s.prototype.$SpotlightMessengerSharedMediaViewer19=function(t,u){var v=null,w=c('PhotoUtils').getImagesFromData(t);w=w.sort(function(y,z){return z.width-y.width;});if(window.devicePixelRatio&&window.devicePixelRatio>1)u=new (c('Vector'))(u.x*window.devicePixelRatio,u.y*window.devicePixelRatio);for(var x=0;x<w.length;x++)if(!v||w[x].width>=u.x||w[x].height>=u.y)v=w[x];return v;};s.propTypes={disableForward:n.bool,hasPrevPage:n.bool,hasNextPage:n.bool,onClosePhotoView:n.func,openAlbum:n.func,photoID:n.string,rootClassName:n.string,threadID:n.string,sharedMedia:n.arrayOf(n.object)};s.getImageDimensionsForStage=function(t,u){var v=t.x,w=t.y,x=u.x,y=u.y,z=v/w,aa=x/y;if(v>=x||w>=y){if(aa<z){v=x;w=Math.round(x/z);}else if(aa>z){v=Math.round(y*z);w=y;}else{v=x;w=y;}}else if(z<aa){v=Math.round(w*z);}else w=Math.round(v/z);return new (c('Vector'))(v,w);};f.exports=s;}),null);
__d('SpotlightMessengerSharedMediaViewerContainer.react',['FluxContainer','MessengerSharedMediaStore','MessengerSharedMediaActions','React','SpotlightMessengerSharedMediaViewer.react'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('React').PureComponent);i=h&&h.prototype;j.getStores=function(){return [c('MessengerSharedMediaStore')];};j.calculateState=function(k,l){var m=c('MessengerSharedMediaStore').getState(),n=m.sharedMedia.get(l.threadID),o=m.isLoading.get(l.threadID);return {sharedMedia:n,isLoading:o};};j.prototype.componentDidMount=function(){c('MessengerSharedMediaActions').loadCurrent(this.props.threadID,this.props.photoID);};j.prototype.render=function(){if(!this.state.sharedMedia)return null;var k=this.state.sharedMedia&&this.state.sharedMedia.edges.find(function(l){return l.node.legacy_attachment_id===this.props.photoID;}.bind(this));if(!k)return null;return (c('React').createElement(c('SpotlightMessengerSharedMediaViewer.react'),{disableForward:this.props.disableForward,hasPrevPage:this.state.sharedMedia&&this.state.sharedMedia.has_previous_page,hasNextPage:this.state.sharedMedia&&this.state.sharedMedia.has_next_page,onClosePhotoView:this.props.onClosePhotoView,openAlbum:this.props.openAlbum,photoID:this.props.photoID,rootClassName:this.props.rootClassName,sharedMedia:this.state.sharedMedia&&this.state.sharedMedia.edges,threadID:this.props.threadID}));};function j(){h.apply(this,arguments);}f.exports=c('FluxContainer').create(j,{withProps:true});}),null);
__d('MessengerThreadSharedPhotos.react',['cx','MercuryConfig','MessengerSharedPhotosAlbumViewContainer.react','React','SpotlightViewer','SpotlightMessengerSharedMediaViewerContainer.react'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={photoView:this.props.findFBID,albumView:''},this.$MessengerThreadSharedPhotos3=function(r){this.setState({albumView:r,photoView:''});}.bind(this),this.$MessengerThreadSharedPhotos4=function(){this.setState({albumView:''});}.bind(this),this.$MessengerThreadSharedPhotos5=function(r){this.setState({albumView:'',photoView:r});}.bind(this),this.$MessengerThreadSharedPhotos6=function(){this.setState({photoView:''});}.bind(this),this.$MessengerThreadSharedPhotos7=function(r){this.setState({photoView:r});}.bind(this),n;}l.prototype.componentDidUpdate=function(){!this.state.photoView&&!this.state.albumView&&this.props.onCloseSharedPhotos();};l.prototype.render=function(){var m=c('MercuryConfig').SharedPhotoNewView&&this.state.photoView?this.$MessengerThreadSharedPhotos1():null,n=c('MercuryConfig').SharedPhotoNewView&&this.state.albumView?this.$MessengerThreadSharedPhotos2():null;return c('React').createElement('div',null,n,m);};l.prototype.$MessengerThreadSharedPhotos1=function(){return (c('React').createElement(c('SpotlightMessengerSharedMediaViewerContainer.react'),{disableForward:false,onClosePhotoView:this.$MessengerThreadSharedPhotos6,openAlbum:this.$MessengerThreadSharedPhotos3,photoID:this.state.photoView,rootClassName:'',threadID:this.props.threadFBID}));};l.prototype.$MessengerThreadSharedPhotos2=function(){return (c('React').createElement(c('SpotlightViewer'),{className:"_3ode",onHide:this.$MessengerThreadSharedPhotos4,open:true,ref:'spotlightViewer'},c('React').createElement(c('MessengerSharedPhotosAlbumViewContainer.react'),{onClick:this.$MessengerThreadSharedPhotos5,onCloseSharedPhotos:this.props.onCloseSharedPhotos,threadID:this.props.threadFBID,viewedPhoto:this.state.albumView})));};l.propTypes={findFBID:k.string,onCloseSharedPhotos:k.func,threadFBID:k.string};f.exports=l;}),null);
__d('MessengerVideo.react',['cx','ix','Image.react','MercuryConfig','MessengerPhoto.react','MessengerVideoPlayer.react','React','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes,m=1800;j=babelHelpers.inherits(n,c('React').PureComponent);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.$MessengerVideo3=function(){var t=void 0;if(!!this.props.attachment.metadata){t=this.props.attachment.metadata.duration;}else if(!!this.props.attachment.media)t=this.props.attachment.media.duration;return !!t?this.$MessengerVideo4(t):null;}.bind(this),this.$MessengerVideo5=function(){this.props.onClick&&this.props.onClick(this.props.attachment);}.bind(this),p;}n.prototype.render=function(){var o=null;if(c('MercuryConfig').MessengerVideoAutoplayControl){var p=this.$MessengerVideo1(this.props.attachment);o=this.$MessengerVideo2(p);}return o?o:c('React').createElement(c('MessengerPhoto.react'),babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_ccq")}),c('React').createElement(c('Image.react'),{className:"_ccr",src:i('/images/chat/chat_play_icon.png')}),c('React').createElement('span',{className:"_ccs"},this.$MessengerVideo3()));};n.prototype.$MessengerVideo2=function(o){if(!o.legacy_attachment_id)return null;return c('React').createElement(c('MessengerVideoPlayer.react'),{attachment:this.props.attachment,videoData:o,isInThread:true,isVisible:this.props.isVisible,onClick:this.$MessengerVideo5,onSelect:this.props.onSelect,className:c('joinClasses')(this.props.className,"_ccq"+(' '+"_4tsk")+(' '+"_3o67")+(this.props.isSingle?' '+"_52mr":''))});};n.prototype.$MessengerVideo1=function(o){var p=null,q=null,r=null;if(o.metadata&&o.metadata.fbid){var s=c('MercuryConfig').MessengerLargePreviewImageGK&&window.screen.width>m&&o.metadata.large_size&&o.metadata.large_preview;p=o.metadata.fbid;var t=s?o.metadata.large_size:o.metadata.inbox_size;q={x:t.width,y:t.height};r=s?o.metadata.large_preview:o.metadata.inbox_preview;}return {legacy_attachment_id:p,original_dimensions:q,start_muted:true,no_autoplay:true,hide_controls_on_finish:true,url:r,is_share:false};};n.prototype.$MessengerVideo4=function(o){var p=o%60;return Math.floor(o/60)+':'+(p<10?'0':'')+p;};n.propTypes={attachment:l.object.isRequired,isSingle:l.bool.isRequired,isVisible:l.bool,onClick:l.func,onSelect:l.func};f.exports=n;}),null);
__d('MessengerXMATextBlock.react',['cx','LineClamp.react','React','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes,l=26;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.$MessengerXMATextBlock1=function(){this.props.url&&window.open(this.props.url);}.bind(this),o;}m.prototype.render=function(){if(!this.props)return c('React').createElement('div',{className:"__6j"});var n=this.props.width?{maxWidth:this.props.width-l,textAlign:'left'}:{textAlign:'left'},o={textDecoration:'none'};return c('React').createElement('div',{className:c('joinClasses')(this.props.className,"__6j _43kk"),style:n},c('React').createElement('a',{onClick:this.$MessengerXMATextBlock1,role:'button',style:o,tabIndex:'0'},this.renderTitle(),this.renderDescription(),this.renderSource()));};m.prototype.renderTitle=function(){if(!this.props.title)return null;return c('React').createElement('div',{className:"__6k"},c('React').createElement(c('LineClamp.react'),{lines:2,lineHeight:16},this.props.title));};m.prototype.renderDescription=function(){if(!this.props.description)return null;return c('React').createElement('div',{className:"__6l"},c('React').createElement(c('LineClamp.react'),{lines:2,lineHeight:15},this.props.description));};m.prototype.renderSource=function(){if(!this.props.source)return null;return c('React').createElement('div',{className:"__6m"},c('React').createElement(c('LineClamp.react'),{lines:1,lineHeight:14},this.props.source));};m.propTypes={className:k.string,description:k.string,source:k.string,title:k.string,url:k.string,width:k.number};f.exports=m;}),null);
__d('MessengerVideoXMA.react',['cx','MessengerVideoPlayer.react','MessengerXMATextBlock.react','React','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes,l=640,m=450,n=320,o=1800;i=babelHelpers.inherits(p,c('React').PureComponent);j=i&&i.prototype;p.prototype.render=function(){var q=this.$MessengerVideoXMA1(this.props.attachment),r=this.$MessengerVideoXMA2(q);return (c('React').createElement('div',{className:"_3duc"},r,this.$MessengerVideoXMA3(q&&q.original_dimensions)));};p.prototype.$MessengerVideoXMA2=function(q){return q?c('React').createElement(c('MessengerVideoPlayer.react'),{attachment:this.props.attachment,videoData:q,isInThread:true,isVisible:this.props.isVisible,onSelect:this.props.onSelect,className:c('joinClasses')(this.props.className,"_ccq"+(' '+"_4tsk")+(' '+"_3o67")+(' '+"_52mr"))}):null;};p.prototype.$MessengerVideoXMA1=function(q){if(!q.media||!q.media.image_size||!q.target||!q.target.video_id)return null;var r=q.media.image_size;return {legacy_attachment_id:q.target.video_id,original_dimensions:this.$MessengerVideoXMA4(r),start_muted:true,no_autoplay:true,hide_controls_on_finish:true,url:q.media.image,is_share:true};};p.prototype.$MessengerVideoXMA4=function(q){var r=Math.max(q.width,q.height),s=this.props.renderLargeSize?window.screen.width>o?l:m:n;if(r<=s)return {x:q.width,y:q.height};var t=s/r,u=Math.floor(q.width*t),v=Math.floor(q.height*t);return {x:u,y:v};};p.prototype.$MessengerVideoXMA3=function(q){var r=this.props.attachment;return (c('React').createElement(c('MessengerXMATextBlock.react'),{className:"_2f5n _4br2 _29ew _3dug",description:r.description,source:r.source,title:r.video_title,url:r.uri,width:q&&q.x}));};function p(){i.apply(this,arguments);}p.propTypes={attachment:k.object.isRequired,isVisible:k.bool,renderLargeSize:k.bool,onClick:k.func,onSelect:k.func};f.exports=p;}),null);
__d('MessengerPhotosGroup.react',['cx','ActorURI','ChatSpeakingSticker.react','MercuryAttachment','MercuryAttachmentType','MercuryConfig','MercuryIDs','MessagingGiftWrap.react','MessagingFlowerBorder.react','MessengerAttachmentViewer','MessengerFromViewerUtils','MessengerPhoto.react','MessengerPhotoForwardButton.react','MessengerVideo.react','MessengerVideoXMA.react','MessagesViewerSetID','React','MessengerThreadSharedPhotos.react','URI','Vector','getPageIDFromThreadID','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k='empty-spacer',l=c('React').PropTypes;i=babelHelpers.inherits(m,c('React').PureComponent);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.state={findID:null},this.$MessengerPhotosGroup5=function(s){this.setState({findID:s});}.bind(this),this.$MessengerPhotosGroup6=function(){this.setState({findID:null});}.bind(this),this.$MessengerPhotosGroup7=function(s){if(s.preview_uploading)return;if(s.attach_type===c('MercuryAttachmentType').VIDEO){c('MessengerAttachmentViewer').renderVideo({pageID:s.metadata.pageid,rootClassName:"_1j1h",videoID:s.metadata.fbid,videoSize:new (c('Vector'))(s.metadata.dimensions.width,s.metadata.dimensions.height),videoURI:s.url});}else if(s.attach_type===c('MercuryAttachmentType').PHOTO||s.attach_type===c('MercuryAttachmentType').THIRDPARTYSTICKER||s.attach_type===c('MercuryAttachmentType').ANIMATED_IMAGE){var t=this.props.attachments.length===1,u=s.url,v=null;if(!this.props.isXMA&&s.attach_type===c('MercuryAttachmentType').PHOTO&&this.props.count){var w=this.props.count,x=this.props.message,y=x&&x.thread_fbid;if(x&&!y)y=c('MercuryIDs').getThreadFBIDFromThreadID(x.thread_id);t=w===1;u=new (c('URI'))('/ajax/messaging/attachments/sharedphotos.php').setQueryData({thread_id:y,image_id:s.metadata.fbid});if(s.metadata.pageid)u=new (c('ActorURI').create)(u,s.metadata.pageid);v=c('MessagesViewerSetID').MESSAGES_VIEW_ALL_IN_THREAD;}c('MessengerAttachmentViewer').bootstrapWithConfig({actorid:s.metadata.pageid,dimensions:s.metadata.dimensions,disableForward:!!s.metadata.pageid,disablePaging:t,endpoint:u,fbid:s.metadata.fbid,rootClassName:"_1j1h",setID:v,snapToPhoto:true,src:s.preview_url});}else if(s.uri)window.open(s.uri);}.bind(this),this.$MessengerPhotosGroup3=function(s){var t=[];s.forEach(function(u){if(u.metadata&&u.metadata.fbid)t.push(u.metadata.fbid.toString());});return t;},o;}m.prototype.componentDidMount=function(){c('MessengerAttachmentViewer').preload();};m.prototype.render=function(){var n=this.props.attachments,o=this.props.message?!!c('getPageIDFromThreadID')(this.props.message.thread_id):false,p=this.$MessengerPhotosGroup1(n,o);if(this.props.isGiftWrapped)p=c('React').createElement('div',null,p);var q=c('MercuryConfig').SharedPhotoNewView&&this.state.findID?this.$MessengerPhotosGroup2():null,r=this.$MessengerPhotosGroup3(n),s=this.props.message?c('MessengerFromViewerUtils').isFromViewer(this.props.message):false,t=c('MercuryConfig').WWWPhotoForwardButtonGK&&r.length===1?c('React').createElement(c('MessengerPhotoForwardButton.react'),{photoIDs:r,isFromViewer:s}):null,u=c('MercuryAttachment').hasAttribution(n[0]),v=!t||u||s?{}:{marginRight:'16px',position:'relative'};return c('React').createElement('div',babelHelpers['extends']({},this.props,{style:v,tabIndex:'0',className:this.$MessengerPhotosGroup4(n)}),q,t,p,this.props.isGiftWrapped?c('React').createElement(c('MessagingGiftWrap.react'),{onUnwrap:this.props.onUnwrap}):null,this.props.hasFlowerBorder?c('React').createElement(c('MessagingFlowerBorder.react'),{offset:-10}):null);};m.prototype.$MessengerPhotosGroup2=function(){var n=this.props.message,o=n&&n.thread_fbid;if(n&&!o)o=c('MercuryIDs').getThreadFBIDFromThreadID(n.thread_id);return c('React').createElement(c('MessengerThreadSharedPhotos.react'),{findFBID:String(this.state.findID.metadata.fbid),backUpClick:this.$MessengerPhotosGroup7,onCloseSharedPhotos:this.$MessengerPhotosGroup6,threadFBID:o});};m.prototype.$MessengerPhotosGroup1=function(n,o){if(n.length===1)return [this.$MessengerPhotosGroup8(n[0],o,true)];var p=3;if(n.length===2||n.length===4)p=2;var q=[];for(var r=0,s=n.length;r<s;r+=p){var t=n.slice(r,r+p),u=p-t.length;while(u>0){t.push({attach_type:k,key:'ghost'+u});u--;}q.push(c('React').createElement('div',{className:"_2n8g",key:r},t.map(function(v){return this.$MessengerPhotosGroup8(v,o);}.bind(this))));}return q;};m.prototype.$MessengerPhotosGroup8=function(n,o,p){var q=void 0;if(n.deduplication_key){q=n.deduplication_key;}else if(n.metadata){q=n.metadata.fbid;}else q=n.upload_id;var r={attachment:n,isSingle:p||false,key:q,onAttachmentLoad:this.props.onAttachmentLoad,onClick:c('MercuryConfig').SharedPhotoNewView&&!o&&!this.props.isPageMessage&&n.metadata&&n.metadata.fbid&&!c('MercuryAttachment').hasAttribution(n)?this.$MessengerPhotosGroup5:this.$MessengerPhotosGroup7},s=this.props.attachType||n.attach_type;switch(s){case c('MercuryAttachmentType').PHOTO:case c('MercuryAttachmentType').ANIMATED_IMAGE:case c('MercuryAttachmentType').THIRDPARTYSTICKER:return c('React').createElement(c('MessengerPhoto.react'),r);case c('MercuryAttachmentType').VIDEO:if(n.metadata&&n.metadata.render_as_sticker){return c('React').createElement(c('ChatSpeakingSticker.react'),{videoSize:n.metadata.dimensions,videoURI:n.url});}else if(this.props.isXMA&&c('MercuryConfig').MessengerSharedVideoNewDesign)return c('React').createElement(c('MessengerVideoXMA.react'),babelHelpers['extends']({},r,{isVisible:this.props.isVisible,onSelect:this.props.onSelect,renderLargeSize:c('MercuryConfig').MessengerLargePreviewImageGK}));return c('React').createElement(c('MessengerVideo.react'),babelHelpers['extends']({},r,{isVisible:this.props.isVisible,onSelect:this.props.onSelect}));case k:return c('React').createElement('div',{key:n.key,className:"_4tsk _4rf-"});default:throw new Error(n.attachType+' is not handled by MessengerPhotoGroup');}};m.prototype.$MessengerPhotosGroup4=function(n){var o=n.length===2||n.length===4;return c('joinClasses')(this.props.className,"_2n8h"+(n.length===1?' '+"_2n8i":'')+(o?' '+"_4ksk":'')+(n.length>1&&!o?' '+"_2n8k":'')+(c('MercuryConfig').MessengerLargePreviewImageGK?' '+"_5fk1":''));};m.propTypes={attachments:l.arrayOf(l.object).isRequired,attachType:l.string,count:l.number,hasFlowerBorder:l.bool,isGiftWrapped:l.bool,isPageMessage:l.bool,isXMA:l.bool,isVisible:l.bool,message:l.object,onAttachmentLoad:l.func,onSelect:l.func,onUnwrap:l.func};f.exports=m;}),null);