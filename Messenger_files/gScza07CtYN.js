if (self.CavalryLogger) { CavalryLogger.start_js(["4JXmi"]); }

__d("MercuryMessageSourceTags",[],(function a(b,c,d,e,f,g){f.exports={CHAT:"source:chat",EMAIL:"source:email",MESSENGER:"source:messenger",MOBILE:"source:mobile"};}),null);
__d("MercurySendMessageFields",[],(function a(b,c,d,e,f,g){f.exports={AUTO_RETRY_CNT:"auto_retry_cnt",MANUAL_RETRY_CNT:"manual_retry_cnt"};}),null);
__d("P2PTransferStatus",[],(function a(b,c,d,e,f,g){f.exports={PENDING_SENDER_MANUAL_REVIEW:1,PENDING_SENDER_VERIFICATION:2,CANCELED_SENDER_RISK:3,PENDING_RECIPIENT_NUX:4,CANCELED_DECLINED:5,PENDING_RECIPIENT_VERIFICATION:6,PENDING_RECIPIENT_MANUAL_REVIEW:7,PENDING_RECIPIENT_PROCESSING:8,PENDING_PUSH_FAIL:9,CANCELED_RECIPIENT_RISK:10,CANCELED_SYSTEM_FAIL:11,CANCELED_EXPIRED:12,COMPLETED:13,INTERMEDIATE_PROCESSING:14,PENDING_SENDER_INITED:15,CANCELED_SAME_CARD:16,PENDING_SENDER_VERIFICATION_PROCESSING:17,PENDING_RECIPIENT_VERIFICATION_PROCESSING:18};}),null);
__d('MercuryMessageObject',['fbt','BanzaiODS','MercuryActionStatus','MercuryActionType','MercuryIDs','MercuryLocalIDs','MercuryMessageClientState','MercuryMessageSourceTags','MercurySingletonProvider','MercurySourceType','MercuryThreads','MercuryTimePassed','MercuryTimestamp','MercurySendMessageFields','formatDate'],(function a(b,c,d,e,f,g,h){i.getForFBID=function(n){'use strict';return m.getForFBID(n);};i.get=function(){'use strict';return m.get();};function i(n){'use strict';this.$MercuryMessageObject1=n;this.$MercuryMessageObject2=c('MercuryThreads').getForFBID(n);}i.prototype.constructUserGeneratedMessageObject=function(n,o,p,q,r){'use strict';var s=j(this.$MercuryMessageObject1,c('MercuryActionType').USER_GENERATED_MESSAGE,o,p);if(typeof n=='string')n=n.replace(/^\s+/,'').replace(/\s+$/,'');s.body=n;s.has_attachment=false;s.html_body=false;s.attachments=[];s.specific_to_list=q||[];s.creator_info=r;return s;};i.prototype.constructStickerMessageObject=function(n,o,p){'use strict';var q=j(this.$MercuryMessageObject1,c('MercuryActionType').USER_GENERATED_MESSAGE,o,p);q.has_attachment=true;q.html_body=false;q.attachments=[];q.sticker_id=n;q.specific_to_list=[];return q;};i.prototype.constructAttachmentMessageObject=function(n,o){'use strict';var p=j(this.$MercuryMessageObject1,c('MercuryActionType').USER_GENERATED_MESSAGE,n,o);p.attachments=[];p.specific_to_list=[];return p;};i.prototype.constructLogMessageObject=function(n,o,p,q){'use strict';var r=j(this.$MercuryMessageObject1,c('MercuryActionType').LOG_MESSAGE,n,o);r.log_message_type=p;r.log_message_data=q;if(q&&q.untypedData&&q.untypedData.ttl)r.ephemeral_ttl_mode=q.untypedData.ttl;return r;};i.prototype.constructCTAConfirmationMessageObject=function(n,o,p,q){'use strict';var r=this.constructUserGeneratedMessageObject(n,o,p,null,null),s={};if(q){s={quick_replies:q,ignore_for_webhook:false};}else s={ignore_for_webhook:true};r.platform_xmd=JSON.stringify(s);return r;};i.prototype.normalizeNewMessage=function(n){'use strict';if(n.status===undefined)n.status=c('MercuryActionStatus').UNSENT;n.timestamp_absolute=h._("Aujourd\u2019hui").toString();n.offline_threading_id=n.offline_threading_id||c('MercuryLocalIDs').generateOfflineThreadingID(n.timestamp);if(!n.offline_threading_id)c('BanzaiODS').bumpEntityKey('chat.web','invalid_otid_generated');n.message_id=n.message_id||n.offline_threading_id;var o=c('MercuryIDs').getParticipantIDFromUserID(this.$MercuryMessageObject1);n.specific_to_list=n.specific_to_list||[];if(n.specific_to_list.length&&n.specific_to_list.indexOf(o)===-1)n.specific_to_list.push(o);if(!n.thread_id){n.thread_id='root:'+n.offline_threading_id;}else{var p=this.$MercuryMessageObject2.getThreadMetaNow(n.thread_id);if(p&&p.ephemeral_ttl_mode!==null&&n.ephemeral_ttl_mode===undefined)n.ephemeral_ttl_mode=p.ephemeral_ttl_mode;}if(n.specific_to_list.length==1){n.thread_id='user:'+this.$MercuryMessageObject1;}else if(n.specific_to_list.length==2){var q=n.specific_to_list[0]==o?n.specific_to_list[1]:n.specific_to_list[0];n.thread_id=c('MercuryIDs').getThreadIDFromParticipantID(q);}if(!n.specific_to_list.length){var r=c('MercuryIDs').tokenize(n.thread_id),s=r.type,t=r.value;if(s=='user')n.specific_to_list=['fbid:'+t,o];}if(!n[c('MercurySendMessageFields').MANUAL_RETRY_CNT])n[c('MercurySendMessageFields').MANUAL_RETRY_CNT]=0;};i.prototype.normalizeResendMessage=function(n){'use strict';n.status=c('MercuryActionStatus').RESENDING;n.timestamp=Date.now();n[c('MercurySendMessageFields').MANUAL_RETRY_CNT]+=1;};i.prototype.normalizeAddAttachmentPlaceholder=function(n,o,p){'use strict';if(p.preview_attachments.length>0){n.has_attachment=true;n.preview_attachments=p.preview_attachments;}n.client_state=c('MercuryMessageClientState').DO_NOT_SEND_TO_SERVER;n.status=c('MercuryActionStatus').RESENDING;n.upload_id=o;};function j(n,o,p,q){var r=l(p)?[c('MercuryMessageSourceTags').CHAT]:[],s=Date.now(),t=c('formatDate')(new Date(s),'g:ia'),u=k(s),v={action_type:o,thread_id:q,author:c('MercuryIDs').getParticipantIDFromUserID(n),author_email:null,timestamp:s,timestamp_absolute:u,timestamp_relative:t,timestamp_time_passed:c('MercuryTimePassed').TODAY,is_unread:false,is_forward:false,is_filtered_content:false,is_filtered_content_bh:false,is_filtered_content_account:false,is_filtered_content_quasar:false,is_filtered_content_invalid_app:false,is_spoof_warning:false,source:p,source_tags:r};return v;}function k(n){try{return new Date(n).toLocaleDateString();}catch(o){var p=c('MercuryTimestamp').getFormatedTimestamp(n);return p.absolute;}}function l(n){switch(n){case c('MercurySourceType').CHAT_WEB:case c('MercurySourceType').CHAT_JABBER:case c('MercurySourceType').CHAT_IPHONE:case c('MercurySourceType').CHAT_MEEBO:case c('MercurySourceType').CHAT_ORCA:case c('MercurySourceType').CHAT_TEST:case c('MercurySourceType').CHAT:return true;default:return false;}}var m=new (c('MercurySingletonProvider'))(i);f.exports=i;}),null);
__d('MercuryMessageActions',['MercuryActionType','MercuryDispatcher','MercuryMessageObject','MercuryPayloadSource','MercuryServerRequests','MercurySingletonMixin'],(function a(b,c,d,e,f,g){'use strict';function h(i){this.$MercuryMessageActions1=i;this.$MercuryMessageActions2=c('MercuryMessageObject').getForFBID(this.$MercuryMessageActions1);this.__serverRequests=c('MercuryServerRequests').getForFBID(this.$MercuryMessageActions1);this.__dispatcher=c('MercuryDispatcher').getForFBID(this.$MercuryMessageActions1);}h.prototype.send=function(i,j,k){j=j||Function.prototype;this.$MercuryMessageActions2.normalizeNewMessage(i);this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload(babelHelpers['extends']({},i),c('MercuryPayloadSource').CLIENT_SEND_MESSAGE));this.__serverRequests.sendNewMessage(i,k);j(i.thread_id);};h.prototype.resend=function(i,j){var k=babelHelpers['extends']({},i);this.$MercuryMessageActions2.normalizeResendMessage(k);this.send(k,undefined,j);};h.prototype.addAttachmentPlaceholder=function(i,j,k){this.$MercuryMessageActions2.normalizeAddAttachmentPlaceholder(i,j,k);this.$MercuryMessageActions2.normalizeNewMessage(i);this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload(babelHelpers['extends']({},i),c('MercuryPayloadSource').CLIENT_SEND_MESSAGE));};h.prototype.cancelAttachmentPlaceholder=function(i,j){this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload({upload_id:i,upload_data:j,action_type:c('MercuryActionType').CANCEL_ATTACHMENT_PLACEHOLDER},c('MercuryPayloadSource').CLIENT_SEND_MESSAGE));};h.prototype.confirmAttachmentPlaceholder=function(i,j){this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload({upload_id:i,upload_data:j,action_type:c('MercuryActionType').CONFIRM_ATTACHMENT_PLACEHOLDER},c('MercuryPayloadSource').CLIENT_SEND_MESSAGE));};h.prototype['delete']=function(i,j,k){this.__dispatcher.handleUpdate(this.$MercuryMessageActions3(i,j,c('MercuryActionType').DELETE_MESSAGES,k||c('MercuryPayloadSource').CLIENT_DELETE_MESSAGES));};h.prototype.unwrap=function(i){this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload({thread_id:i.thread_id,unwrapped_message_id:i.message_id,action_type:c('MercuryActionType').UNWRAP_MESSAGE},c('MercuryPayloadSource').CLIENT_UNWRAP_MESSAGE));};h.prototype.__constructClientSingleMessagePayload=function(i,j){return {actions:[i],from_client:true,payload_source:j};};h.prototype.$MercuryMessageActions4=function(i,j){return {actions:[i],from_client:false,payload_source:j};};h.prototype.$MercuryMessageActions3=function(i,j,k,l){return {actions:[{action_type:k,thread_id:i,message_ids:j}],from_client:true,payload_source:l};};Object.assign(h,c('MercurySingletonMixin'));f.exports=h;}),null);
__d('MessengerDesktopNotificationPermissions',[],(function a(b,c,d,e,f,g){var h={DEFAULT:'default',DENIED:'denied',GRANTED:'granted'};f.exports=h;}),null);
__d('MessengerDesktopNotifications',['Map','MessengerDesktopNotificationPermissions','Run','UserAgent'],(function a(b,c,d,e,f,g){'use strict';var h=5000,i=new (c('Map'))();function j(){i.forEach(function(l,m,n){l.close&&l.close();});}var k={_closeTimer:null,isSupported:function l(){return !!window.Notification;},checkPermission:function l(){if(window.Notification)return window.Notification.permission;},hasDefaultSound:function l(){return c('UserAgent').isBrowser('FireFox')&&c('UserAgent').isPlatform('Mac OS X');},isDenied:function l(){return this.checkPermission()===c('MessengerDesktopNotificationPermissions').DENIED;},isGranted:function l(){return this.checkPermission()===c('MessengerDesktopNotificationPermissions').GRANTED;},requestPermission:function l(m){if(window.Notification)window.Notification.requestPermission(m);},showNotification:function l(m){if(this.checkPermission()===c('MessengerDesktopNotificationPermissions').GRANTED){var n=window.Notification?new window.Notification(m.title,{body:m.body,icon:m.icon,tag:m.tag}):{};i.set(m.tag,n);n.onclick=m.onClick;n.onclose=function(){i['delete'](m.tag);};this._closeTimer=setTimeout(function(){n.close();},m.closeTime||h);return n;}else return null;}};c('Run').onUnload(j);f.exports=k;}),null);
__d("XMessengerDotComSettingsEditController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/settings\/edit\/",{});}),null);
__d('MessengerSettingsActions',['AsyncRequest','CurrentEnvironment','MessengerDispatcher','MessengerDesktopNotifications','MessengerDesktopNotificationPermissions','MessengerURIConstants','XMessengerDotComSettingsEditController','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({CHANGE_SETTINGS:null,CHANGE_DESKTOP_NOTIFS:null}),i={Types:h,changeSettings:function j(k){var l=c('XMessengerDotComSettingsEditController').getURIBuilder().getURI();if(c('CurrentEnvironment').facebookdotcom)l.setPath(c('MessengerURIConstants').FACEBOOK_PREFIX+l.getPath());new (c('AsyncRequest'))().setData({settings:k}).setURI(l).send();c('MessengerDispatcher').dispatch({type:h.CHANGE_SETTINGS,newSettings:k});},changeDesktopNotifs:function j(k,l){if(k&&!c('MessengerDesktopNotifications').isGranted()){c('MessengerDesktopNotifications').requestPermission(function(m){if(m!==c('MessengerDesktopNotificationPermissions').GRANTED){if(c('MessengerDesktopNotifications').checkPermission()===c('MessengerDesktopNotificationPermissions').DENIED)l&&l();return;}c('MessengerDispatcher').dispatch({type:h.CHANGE_DESKTOP_NOTIFS,desktopNotifsEnabled:k});});}else c('MessengerDispatcher').dispatch({type:h.CHANGE_DESKTOP_NOTIFS,desktopNotifsEnabled:k});}};f.exports=i;}),null);
__d('MercuryTriodeSourceUtil',['MessengerEnvironment','MercurySourceType'],(function a(b,c,d,e,f,g){'use strict';var h={getMercuryTriodeSource:function i(){return c('MessengerEnvironment').messengerdotcom?c('MercurySourceType').MESSENGER_WEB:c('MercurySourceType').TITAN_WEB;}};f.exports=h;}),null);
__d('SoundPlayer',['URI','createArrayFromMixed'],(function a(b,c,d,e,f,g){var h=null,i={};function j(p){var q=new (c('URI'))(p);if(!q.getDomain())return new (c('URI'))(window.location.href).setPath(q.getPath()).toString();return p;}function k(p){var q=new (c('URI'))(p).getPath();if(/\.mp3$/.test(q))return 'audio/mpeg';if(/\.og[ga]$/.test(q))return 'audio/ogg';return '';}function l(){if(!h){var p=document.createElement('audio');if(!p||!p.canPlayType)return null;p.setAttribute('preload','auto');document.body.appendChild(p);h=p;}return h;}function m(p){return i[p];}function n(p,q){i[p]=q;}var o={init:function p(q){},createAndPlayNewNative:function p(q,r){var s=document.createElement('audio');s.setAttribute('preload','auto');document.body.appendChild(s);s.src=j(q);if(r){s.setAttribute('loop','');}else s.removeAttribute('loop');s.play();n(q,s);return;},play:function p(q,r){q=c('createArrayFromMixed')(q);var s=l();for(var t=0;s&&t<q.length;++t){var u=q[t],v=m(u);if(v){if(r){v.setAttribute('loop','');}else v.removeAttribute('loop');v.play();return;}var w=k(u);if(!s.canPlayType(w))continue;o.createAndPlayNewNative(u,r);return;}},stop:function p(q){q=c('createArrayFromMixed')(q);for(var r=0;r<q.length;++r){var s=j(q[r]),t=m(q[r]);if(t&&t.src==s){t.pause();t.removeAttribute('src');t.src=s;}}}};f.exports=o;}),null);
__d('StoreAndPropBasedStateMixin',['invariant','StoreBasedStateMixinHelper','setImmediate'],(function a(b,c,d,e,f,g,h){'use strict';var i=function(){for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];return {getInitialState:function m(){return this.constructor.calculateState(this.props);},componentWillMount:function m(){this.constructor.calculateState||h(0);this._recalculateStateID=null;var n=function(){if(this.isMounted())this.setState(this.constructor.calculateState(this.props));this._recalculateStateID=null;}.bind(this);this._mixin=new (c('StoreBasedStateMixinHelper'))(k);this._mixin.subscribeCallback(function(){if(this._recalculateStateID===null)this._recalculateStateID=c('setImmediate')(n);}.bind(this));},componentWillReceiveProps:function m(n){this.setState(this.constructor.calculateState(n));},componentWillUnmount:function m(){this._mixin.release();this._mixin=null;}};}.bind(this);f.exports=i;}),null);