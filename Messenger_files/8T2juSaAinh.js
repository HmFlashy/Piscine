if (self.CavalryLogger) { CavalryLogger.start_js(["\/0Pgj"]); }

__d("ResourceTimingMetricsEnumJS",[],(function a(b,c,d,e,f,g){f.exports={START_TIME:"startTime",REDIRECT_START:"redirectStart",REDIRECT_END:"redirectEnd",FETCH_START:"fetchStart",DOMAIN_LOOKUP_START:"domainLookupStart",DOMAIN_LOOKUP_END:"domainLookupEnd",CONNECT_START:"connectStart",SECURE_CONNECTION_START:"secureConnectionStart",CONNECT_END:"connectEnd",REQUEST_START:"requestStart",RESPONSE_START:"responseStart",RESPONSE_END:"responseEnd"};}),null);
__d('ImageTimingHelper',['Arbiter','BigPipe','URI'],(function a(b,c,d,e,f,g){var h={},i={};c('Arbiter').subscribe(c('BigPipe').Events.init,function(j,k){if(k.lid&&k.lid!=='0')k.arbiter.subscribe('images_displayed',function(l,m){var n=h[m.lid];if(!n)n=h[m.lid]=[];m.images.forEach(function(o){try{var q=new (c('URI'))(o);o=q.setFragment('').toString();}catch(p){return;}if(i[o])return;i[o]=true;n.push({pagelet:m.pagelet,timeslice:m.timeslice,ts:m.ts,uri:o});});});});f.exports.getImageTimings=function(j){return h[j]||[];};}),null);
__d('ResourceTimingBootloaderHelper',['Bootloader','ResourceTimingMetricsEnumJS','ImageTimingHelper','URI','forEachObject','isEmpty','performance'],(function a(b,c,d,e,f,g){var h={},i={};function j(p,q,r,s,t){if(!c('performance').timing||!c('performance').getEntriesByType)return;var u={};if(r)u=c('ImageTimingHelper').getImageTimings(s).sort(function(la,ma){return la.ts-ma.ts;}).reduce(function(la,ma){if(la[ma.uri])return la;la[ma.uri]=ma.pagelet;return la;},{});var v=c('performance').getEntriesByType('resource'),w=0,x=0,y=0;for(var z=0;z<v.length;z++){var aa=v[z];if(aa.duration<=0||aa.startTime<q||t!=null&&aa.responseEnd!=null&&t<aa.responseEnd)continue;var ba='',ca='',da='',ea='',fa='',ga=aa.initiatorType;switch(ga){case 'css':case 'link':case 'script':var ha=n(aa.name);ca=ha[0];ba=ha[1];if(!ca||!ba)continue;if(ba==='css'||ba==='js'){ea=ba;var ia=i[aa.name]||x++;da=ia+'_'+ca;}else{var ja=m(aa.name);fa=ja[0];ea=ja[1];da=w+++'_'+fa;}break;case 'img':da=w+++'_'+k(aa.name);ea='img';break;case 'iframe':da=y+++'_'+k(aa.name)+l(aa.name);ea='iframe';break;default:continue;}if(p[aa.name]==undefined)p[aa.name]=[];var ka={};c('forEachObject')(c('ResourceTimingMetricsEnumJS'),function(la){var ma=aa[la];if(ma)ka[la]=ma+c('performance').timing.navigationStart;});ka.type=ea;ka.desc=da;if(ea=='img'&&u.hasOwnProperty(aa.name))ka.pagelet=u[aa.name];ka.transferSize=aa.transferSize;ka.encodedBodySize=aa.encodedBodySize;p[aa.name].push(ka);}}function k(p){var q=new (c('URI'))(p).getDomain();return q;}function l(p){var q=new (c('URI'))(p).getPath();return q;}function m(p){return [k(p),'img'];}function n(p){var q=p.match(/\/rsrc\.php\/.*\/([^\?]+)/);if(!q)return [];var r=q[1],s='',t=r.match(/\.(\w+)$/);if(t)s=t[1];return [r,s];}var o={addBootloaderMetricsToResourceTimings:function p(){var q=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],r=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],s=arguments.length<=2||arguments[2]===undefined?true:arguments[2];if(c('isEmpty')(i))i=c('Bootloader').getURLToHashMap();var t={};c('forEachObject')(i,function(w,x){t[w]=x;});var u={bootload:true,js_exec:true,start_bootload:true,tag_bootload:true},v=[];c('forEachObject')(r,function(w,x){var y=x.indexOf('/');if(y===-1)return;var z=x.substring(0,y);if(!u[z])return;v.push(x);var aa=x.substring(y+1),ba=t[aa];if(!ba){ba=aa;aa=i[ba];if(!aa)return;}if(ba.startsWith('data:'))ba='inlined resource: '+aa;if(q[ba]==null)q[ba]=[{}];q[ba].forEach(function(ca){ca.bootloader_hash=aa;ca[z]=w;});});if(!s)v.forEach(function(w){return delete r[w];});return q;},getLastTTIAndE2EImageResponseEnds:function p(q,r,s){var t={TTI:q,E2E:r};if(!c('performance').timing)return t;var u=s.filter(function(x){return x.ts<=q;}).map(function(x){return x.uri;}).reduce(function(x,y){x[y]=true;return x;},{}),v=s.map(function(x){return x.uri;}).reduce(function(x,y){x[y]=true;return x;},{});for(var w in h)h[w].forEach(function(x){if(x.type==='img'){if(u[w])t.TTI=Math.max(t.TTI,x.responseEnd);if(v[w])t.E2E=Math.max(t.E2E,x.responseEnd);}});return t;},getMetrics:function p(q,r,s,t){h={};if(c('isEmpty')(i))i=c('Bootloader').getURLToHashMap();j(h,q,r,s,t);return h;}};f.exports=o;}),null);