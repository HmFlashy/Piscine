if (self.CavalryLogger) { CavalryLogger.start_js(["k\/+7k"]); }

__d('Tooltip.react',['React','TooltipMixin'],(function a(b,c,d,e,f,g){var h=c('React').PropTypes,i=c('React').createClass({displayName:'Tooltip',propTypes:{display:h.oneOf(['inline','block'])},getDefaultProps:function j(){return {display:'inline'};},mixins:[c('TooltipMixin')],render:function j(){if(this.props.display==='block')return (c('React').createElement('div',this.props,this.props.children));return c('React').createElement('span',this.props,this.props.children);}});f.exports=i;}),null);
__d('FacepileRounded.react',['cx','Image.react','React','Tooltip.react','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.render=function(){var m=this.props,n=m.className,o=m.profiles,p=m.message,q=m.numProfilesToDisplay,r=null;if(p)r=c('React').createElement('div',{className:"_4mnt"},p);var s=q?o.slice(0,q).map(function(t,u){return (this.$FacepileRounded1(t,u));}.bind(this)):o.map(function(t,u){return this.$FacepileRounded1(t,u);}.bind(this));return (c('React').createElement('div',{className:c('joinClasses')("_4mnv",n)},c('React').createElement('div',{className:"_4mnw"},s,this.$FacepileRounded2()),r));};l.prototype.$FacepileRounded2=function(){var m=this.props,n=m.direction,o=m.imageSize,p=m.profiles,q=m.remainingProfilesCount,r=m.numProfilesToDisplay;if(!r)return null;var s=q?q:p.length-r;return (s>0?c('React').createElement('span',{className:"_4mnq _34n6",style:{borderRadius:o,height:o,marginLeft:-(o*.3125)+'px',minWidth:o,position:n==='descending'?'relative':null,zIndex:n==='descending'?0:null}},c('React').createElement('span',{className:"_40vg"},'+'+s)):null);};l.prototype.$FacepileRounded1=function(m,n){var o=this.props,p=o.direction,q=o.imageSize,r=o.profiles,s=o.showNames,t={};if(n>0)t.marginLeft=-(q*.3125)+'px';if(p==='descending'){t.position='relative';t.zIndex=r.length-n;}var u=c('React').createElement(c('Image.react'),{className:"_4mnq",height:q,key:n+m.image_src,style:s?null:t,src:m.image_src,width:q});if(s&&m.name)u=c('React').createElement(c('Tooltip.react'),{className:"_4mns",key:n+m.image_src,style:t,tooltip:m.name},u);return u;};function l(){i.apply(this,arguments);}l.defaultProps={direction:'ascending',imageSize:32,showNames:false};l.propTypes={className:k.string,direction:k.string,imageSize:k.number,message:k.string,numProfilesToDisplay:k.number,remainingProfilesCount:k.number,profiles:k.arrayOf(k.shape({image_src:k.any.isRequired,name:k.string})).isRequired,showNames:k.bool};f.exports=l;}),null);
__d('FBCheckbox.react',['cx','Keys','React','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.$FBCheckbox1=function(){if(this.props.disabled)return;if(this.props.onToggle)this.props.onToggle(!this.props.checked);}.bind(this),this.$FBCheckbox2=function(event){switch(event.keyCode){case c('Keys').SPACE:event.preventDefault();this.$FBCheckbox1();break;default:break;}}.bind(this),n;}l.prototype.render=function(){var m="_kx6"+(this.props.checked?' '+"_kx7":'')+(this.props.disabled?' '+"_kx8":'')+(this.props.hovered?' '+"_kx9":'')+(!this.props.checked?' '+"_kxa":'');return c('React').createElement('div',{'aria-checked':this.props.checked?'true':'false','aria-disabled':this.props.disabled?'true':'false',className:c('joinClasses')(m,this.props.className),onClick:this.$FBCheckbox1,onKeyDown:this.$FBCheckbox2,role:'checkbox',tabIndex:'0'});};l.propTypes={checked:k.bool.isRequired,className:k.string,disabled:k.bool,hovered:k.bool,onToggle:k.func};f.exports=l;}),null);
__d('MessengerGroupPollingUtils',['ix','CurrentUser','EditorState','FacepileRounded.react','MercuryConfig','MercuryIDs','MercuryParticipants','MessengerTextWithEntities.react','React','TextWithEntities.react','getVisibleValueForContentState','getVisibleValueForContentStateWithMessengerEmoji'],(function a(b,c,d,e,f,g,h){'use strict';var i=2,j={renderEmojiText:function k(l){if(c('MercuryConfig').MessengerNewEmojiGK){return (c('React').createElement(c('MessengerTextWithEntities.react'),{renderEmoji:true,renderEmoticons:true,text:l}));}else return (c('React').createElement(c('TextWithEntities.react'),{renderEmoji:true,renderEmoticons:true,text:l}));},getEmojiText:function k(l){var m=l.getCurrentContent();return c('MercuryConfig').MessengerNewEmojiGK?c('getVisibleValueForContentStateWithMessengerEmoji')(m):c('getVisibleValueForContentState')(m);},renderVoterFacepiles:function k(l,m,n,o,p){return (c('React').createElement(c('FacepileRounded.react'),{className:l,imageSize:m,direction:'descending',numProfilesToDisplay:i,remainingProfilesCount:n-i,profiles:this._getProfilePictures(o,p),showNames:true}));},_getProfilePictures:function k(l,m){if(m===true){var n=c('CurrentUser').getID(),o=l.indexOf(n);if(o!==-1){var p=l[o];l[o]=l[0];l[0]=p;}}var q=l.slice(0,i).map(function(s){var t=c('MercuryIDs').getParticipantIDFromUserID(s),u=c('MercuryParticipants').getOrFetch(t);return {image_src:u&&u.image_src||h('/images/silhouettes/person_50x50.png'),name:u&&u.name||'Facebook User'};}),r=l.slice(i,l.length).map(function(s){return {image_src:s,name:''};});return q.concat(r);}};f.exports=j;}),null);
__d("XMessengerGroupPollingCreatePollController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/messaging\/group_polling\/create_poll\/",{});}),null);
__d('MessengerGroupPollingCreatePollFlyout.react',['cx','fbt','ix','AsyncRequest','DraftEditor.react','EditorState','FBCheckbox.react','Image.react','Keys','MessengerGroupPollingUtils','MessengerSpinner.react','React','ScrollableArea.react','XMessengerGroupPollingCreatePollController','XUICloseButton.react'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m=c('React').PropTypes,n=j('/images/mercury/clients/messenger/group_polling/add-icon.png'),o=20,p=30,q=75,r=200,s=100,t=140,u=140;k=babelHelpers.inherits(v,c('React').Component);l=k&&k.prototype;function v(){var w,x;for(var y=arguments.length,z=Array(y),aa=0;aa<y;aa++)z[aa]=arguments[aa];return x=(w=l.constructor).call.apply(w,[this].concat(z)),this.state={questionText:c('EditorState').createEmpty(),options:[{optionText:c('EditorState').createEmpty(),isSelected:false}],errorTitle:null,errorMessage:null,isLoading:false},this.$MessengerGroupPollingCreatePollFlyout9=function(){if(c('MessengerGroupPollingUtils').getEmojiText(this.state.questionText).length>=u){this.setState({errorTitle:i._("Poll Question Too Long"),errorMessage:i._("The maximum number of characters for a poll question is {max_number_of_options}.",[i.param('max_number_of_options',u)])});return 'handled';}return 'not-handled';}.bind(this),this.$MessengerGroupPollingCreatePollFlyout4=function(ba){ba.stopPropagation();this.$MessengerGroupPollingCreatePollFlyout6();return 'handled';}.bind(this),this.$MessengerGroupPollingCreatePollFlyout7=function(ba){ba.stopPropagation();if(ba.keyCode===c('Keys').RETURN)this.$MessengerGroupPollingCreatePollFlyout6();}.bind(this),this.$MessengerGroupPollingCreatePollFlyout6=function(){var ba=this.state.options.length;if(ba<s){var ca={optionText:c('EditorState').moveFocusToEnd(c('EditorState').createEmpty()),isSelected:false},da=this.state.options.concat(ca);this.setState({options:da});}else this.setState({errorTitle:i._("Trop d\u2019options de sondage"),errorMessage:i._("Les sondages peuvent compter jusqu\u2019\u00e0 {max_number_of_options} options.",[i.param('max_number_of_options',s)])});}.bind(this),this.$MessengerGroupPollingCreatePollFlyout8=function(ba){this.setState({questionText:ba,errorTitle:null,errorMessage:null});}.bind(this),this.$MessengerGroupPollingCreatePollFlyout10=function(ba){var ca=this.state.options.map(function(da,ea){if(ea===0)return babelHelpers['extends']({},da,{optionText:c('EditorState').moveFocusToEnd(c('EditorState').createEmpty())});return da;});this.setState({options:ca});return 'handled';}.bind(this),this.$MessengerGroupPollingCreatePollFlyout12=function(ba){ba.stopPropagation();if(ba.keyCode===c('Keys').RETURN)this.$MessengerGroupPollingCreatePollFlyout11();}.bind(this),this.$MessengerGroupPollingCreatePollFlyout11=function(){if(this.state.isLoading)return;this.setState({isLoading:true});var ba=c('MessengerGroupPollingUtils').getEmojiText(this.state.questionText),ca=this.state.options.filter(function(ea){return c('MessengerGroupPollingUtils').getEmojiText(ea.optionText);}),da=c('XMessengerGroupPollingCreatePollController').getURIBuilder().getURI();new (c('AsyncRequest'))().setURI(da).setData({question_text:ba,target_id:this.props.threadFBID,option_text_array:ca.map(function(ea){return c('MessengerGroupPollingUtils').getEmojiText(ea.optionText);}),option_is_selected_array:ca.map(function(ea){return ea.isSelected?1:0;})}).setMethod('POST').setAllowCrossPageTransition(true).setHandler(function(ea){var fa=ea.payload;if(fa.status==='failure'&&fa.showUser===true){this.setState({errorTitle:fa.errorTitle,errorMessage:fa.errorMessage,isLoading:false});}else this.props.onSubmitHandler();}.bind(this)).send();}.bind(this),x;}v.prototype.componentDidMount=function(){this.setState({questionText:c('EditorState').moveFocusToEnd(this.state.questionText)});};v.prototype.render=function(){var w=this.state.options.map(function(da,ea){return c('React').createElement('div',{className:"_3zwe",key:ea},c('React').createElement(c('FBCheckbox.react'),{checked:da.isSelected,onToggle:function(){return this.$MessengerGroupPollingCreatePollFlyout1(ea);}.bind(this)}),c('React').createElement('div',{className:"_5jmk"},c('React').createElement(c('DraftEditor.react'),{editorState:da.optionText,onChange:function(fa){return this.$MessengerGroupPollingCreatePollFlyout2(fa,ea);}.bind(this),handleBeforeInput:function(fa){return this.$MessengerGroupPollingCreatePollFlyout3(fa,da.optionText);}.bind(this),handleReturn:this.$MessengerGroupPollingCreatePollFlyout4,placeholder:i._("Ajouter une option").toString(),spellCheck:true})),c('React').createElement(c('XUICloseButton.react'),{className:"_4y_1",onClick:function(){return this.$MessengerGroupPollingCreatePollFlyout5(ea);}.bind(this),size:'small',tooltip:i._("Supprimer")}));}.bind(this)),x=c('React').createElement('div',{className:"_3zwe"},c('React').createElement('div',{className:"_5n1-",onClick:this.$MessengerGroupPollingCreatePollFlyout6,onKeyUp:this.$MessengerGroupPollingCreatePollFlyout7,role:'button',tabIndex:'0'},c('React').createElement(c('Image.react'),{className:"_8kj",src:n,height:o,width:o}))),y=c('React').createElement('div',{className:"_5jmn"},this.state.errorTitle),z=c('React').createElement('div',{className:"_5jmo"},this.state.errorMessage),aa=q,ba=w.length+1,ca=p*ba;if(ca<q){aa=q;}else if(ca>r){aa=r;}else aa=ca;return c('React').createElement('div',{className:"_5jmp"},c('React').createElement('div',{className:"_5jn1"},i._("Sondage")),y,z,c('React').createElement('div',{className:"_5jn2"},c('React').createElement(c('DraftEditor.react'),{editorState:this.state.questionText,onChange:this.$MessengerGroupPollingCreatePollFlyout8,handleBeforeInput:this.$MessengerGroupPollingCreatePollFlyout9,handleReturn:this.$MessengerGroupPollingCreatePollFlyout10,placeholder:i._("Poser une question").toString(),spellCheck:true})),c('React').createElement(c('ScrollableArea.react'),{className:"_5nkw",height:aa},c('React').createElement('div',{className:"_5jn3"},w,x)),c('React').createElement('div',{className:"_5jn4"+(this.state.isLoading?' '+"_2zwp":''),onClick:this.$MessengerGroupPollingCreatePollFlyout11,onKeyUp:this.$MessengerGroupPollingCreatePollFlyout12,role:'button',tabIndex:'0'},this.state.isLoading?c('React').createElement(c('MessengerSpinner.react'),null):i._("Cr\u00e9er un sondage")));};v.prototype.$MessengerGroupPollingCreatePollFlyout1=function(w){var x=this.state.options.map(function(y,z){if(z===w)return babelHelpers['extends']({},y,{isSelected:!y.isSelected});return y;});this.setState({options:x});};v.prototype.$MessengerGroupPollingCreatePollFlyout3=function(w,x){if(c('MessengerGroupPollingUtils').getEmojiText(x).length>=t){this.setState({errorTitle:i._("Option de sondage trop longue"),errorMessage:i._("Une option de sondage ne peut pas contenir plus de {max_number_of_options} caract\u00e8res.",[i.param('max_number_of_options',t)])});return 'handled';}return 'not-handled';};v.prototype.$MessengerGroupPollingCreatePollFlyout5=function(w){var x=this.state.options.filter(function(y,z){return z!==w;});this.setState({options:x});};v.prototype.$MessengerGroupPollingCreatePollFlyout2=function(w,x){var y=this.state.options.map(function(z,aa){if(aa===x)return babelHelpers['extends']({},z,{optionText:w});return z;});this.setState({options:y,errorTitle:null,errorMessage:null});};v.propTypes={threadFBID:m.string.isRequired,onSubmitHandler:m.func.isRequired};f.exports=v;}),null);
__d("XMessengerGroupPollingUpdateVoteController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/messaging\/group_polling\/update_vote\/",{});}),null);
__d('MessengerGroupPollingFlyout.react',['cx','fbt','ix','AsyncRequest','DraftEditor.react','EditorState','FBCheckbox.react','Image.react','Keys','MessengerEnvironment','MessengerGroupPollingUtils','MessengerSpinner.react','React','ScrollableArea.react','XMessengerGroupPollingUpdateVoteController'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m=c('React').PropTypes,n=16,o=24,p=28,q=36,r=50,s=200,t=j('/images/mercury/clients/messenger/group_polling/add-icon.png'),u=20,v=100,w=140;k=babelHelpers.inherits(x,c('React').Component);l=k&&k.prototype;function x(y){l.constructor.call(this,y);this.$MessengerGroupPollingFlyout4=function(aa){aa.stopPropagation();if(aa.keyCode===c('Keys').RETURN)this.$MessengerGroupPollingFlyout3();}.bind(this);this.$MessengerGroupPollingFlyout3=function(){var aa=this.props.options&&this.props.options.length||0,ba=aa+this.state.newOptionEditorStates.length;if(ba<v){var ca=c('EditorState').moveFocusToEnd(c('EditorState').createEmpty()),da=this.state.newOptionEditorStates.concat(ca);this.setState({newOptionEditorStates:da});}else this.setState({errorTitle:i._("Trop d\u2019options de sondage"),errorMessage:i._("Les sondages peuvent compter jusqu\u2019\u00e0 {max_number_of_options} options.",[i.param('max_number_of_options',v)])});}.bind(this);this.$MessengerGroupPollingFlyout7=function(aa){aa.stopPropagation();this.$MessengerGroupPollingFlyout3();return 'handled';}.bind(this);this.$MessengerGroupPollingFlyout9=function(aa){aa.stopPropagation();if(aa.keyCode===c('Keys').RETURN)this.$MessengerGroupPollingFlyout8();}.bind(this);this.$MessengerGroupPollingFlyout8=function(){if(this.state.isLoading)return;this.setState({isLoading:true});var aa=this.state.newOptionEditorStates.map(function(ca){return c('MessengerGroupPollingUtils').getEmojiText(ca);}).filter(function(ca){return ca;}),ba=c('XMessengerGroupPollingUpdateVoteController').getURIBuilder().getURI();new (c('AsyncRequest'))().setURI(ba).setData({question_id:this.props.questionID,selected_options:this.state.selectedOptions,new_options:aa}).setMethod('POST').setAllowCrossPageTransition(true).setHandler(function(ca){var da=ca.payload;if(da.status==='failure'&&da.showUser===true){this.setState({errorTitle:da.errorTitle,errorMessage:da.errorMessage,isLoading:false});}else this.props.onSubmitHandler();}.bind(this)).send();}.bind(this);var z=this.$MessengerGroupPollingFlyout1(y.options);this.state={selectedOptions:z,errorTitle:null,errorMessage:null,newOptionEditorStates:[],isLoading:false};}x.prototype.componentDidMount=function(){this.setState({newOptionEditorStates:[c('EditorState').moveFocusToEnd(c('EditorState').createEmpty())]});};x.prototype.componentWillReceiveProps=function(y){if(this.props.options==null){var z=this.$MessengerGroupPollingFlyout1(y.options);this.setState({selectedOptions:z});}};x.prototype.render=function(){var y=c('MessengerEnvironment').messengerui;if(!this.props.options)return c('React').createElement('div',{className:"_8bt"+(!y?' '+"_5il4":'')},c('React').createElement(c('MessengerSpinner.react'),{color:'grey'}));var z=y?o:n,aa=c('React').createElement('div',{className:"_3lpw"},c('React').createElement('div',{className:"_3lpx"},this.state.errorTitle),c('React').createElement('div',{className:"_3lpy"},this.state.errorMessage)),ba=this.props.options&&this.props.options.map(function(ga){return c('React').createElement('div',{className:"_1mqz"+(!y?' '+"_5k8c":''),key:ga.id},c('React').createElement(c('FBCheckbox.react'),{checked:this.state.selectedOptions&&this.state.selectedOptions.indexOf(ga.id)!==-1||false,onToggle:function(){return this.$MessengerGroupPollingFlyout2(ga.id);}.bind(this)}),c('React').createElement('div',{className:"_2f83"},c('React').createElement('div',{className:"_1mq-"},c('MessengerGroupPollingUtils').renderEmojiText(ga.text)),c('MessengerGroupPollingUtils').renderVoterFacepiles("_4ic7"+(!y?' '+"_8kg":''),z,ga.voters.count,ga.voters.edges.map(function(ha){return ha.node.id;}),ga.viewer_has_voted)));}.bind(this)),ca=this.state.newOptionEditorStates.map(function(ga,ha){return c('React').createElement('div',{className:"_1mqz"+(!y?' '+"_5k8c":''),key:ha},c('React').createElement('div',{className:"_8i7",onClick:this.$MessengerGroupPollingFlyout3,onKeyUp:this.$MessengerGroupPollingFlyout4,role:'button',tabIndex:'0'},c('React').createElement(c('Image.react'),{className:"_8ki",src:t,height:u,width:u})),c('React').createElement('div',{className:"_8i5"},c('React').createElement(c('DraftEditor.react'),{editorState:ga,onChange:function(ia){return this.$MessengerGroupPollingFlyout5(ia,ha);}.bind(this),handleBeforeInput:function(ia){return this.$MessengerGroupPollingFlyout6(ia,ga);}.bind(this),handleReturn:this.$MessengerGroupPollingFlyout7,placeholder:i._("Ajouter une option").toString(),spellCheck:true})));}.bind(this)),da=r;if(ba){var ea=ba.length+ca.length,fa=y?q*ea:p*ea;if(fa<r){da=r;}else if(fa>s){da=s;}else da=fa;}return c('React').createElement('div',{className:"_1mq_"+(!y?' '+"_1mr-":'')},c('React').createElement('div',{className:"_1mr_"},c('MessengerGroupPollingUtils').renderEmojiText(this.props.questionText)),aa,c('React').createElement(c('ScrollableArea.react'),{height:da},c('React').createElement('div',{className:"_1ms0"},ba,ca)),c('React').createElement('div',{className:"_1ms1"+(this.state.isLoading?' '+"_m1v":''),onClick:this.$MessengerGroupPollingFlyout8,onKeyUp:this.$MessengerGroupPollingFlyout9,role:'button',tabIndex:'0'},this.state.isLoading?c('React').createElement(c('MessengerSpinner.react'),null):i._("Envoyer")));};x.prototype.$MessengerGroupPollingFlyout1=function(y){var z=y&&y.filter(function(aa){return aa.viewer_has_voted===true;}).map(function(aa){return aa.id;});return z;};x.prototype.$MessengerGroupPollingFlyout2=function(y){var z=this.state.selectedOptions;if(!z)return;var aa=z.indexOf(y)===-1?z.concat(y):z.filter(function(ba){return ba!==y;});this.setState({selectedOptions:aa});};x.prototype.$MessengerGroupPollingFlyout5=function(y,z){var aa=this.state.newOptionEditorStates.map(function(ba,ca){return ca===z?y:ba;});this.setState({newOptionEditorStates:aa,errorTitle:null,errorMessage:null});};x.prototype.$MessengerGroupPollingFlyout6=function(y,z){if(c('MessengerGroupPollingUtils').getEmojiText(z).length>=w){this.setState({errorTitle:i._("Option de sondage trop longue"),errorMessage:i._("Une option de sondage ne peut pas contenir plus de {max_number_of_options} caract\u00e8res.",[i.param('max_number_of_options',w)])});return 'handled';}return 'not-handled';};x.propTypes={questionID:m.string.isRequired,questionText:m.string.isRequired,options:m.arrayOf(Object),onSubmitHandler:m.func.isRequired};f.exports=x;}),null);